(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d636220e"],{"14a7":function(e,t,r){"use strict";r("4f4f")},"1b64":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:"导入数据",width:"50%"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[r("div",{staticClass:"form-page"},[r("el-form",{ref:"form",attrs:{model:e.importData,rules:e.rules,"label-width":"7em",disabled:"view"==e.method},on:{validate:e.formValidated}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"所属分类：",prop:"classifyId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属分类",size:e.size},model:{value:e.importData.classifyId,callback:function(t){e.$set(e.importData,"classifyId",t)},expression:"importData.classifyId"}},e._l(e.allClassifyTypeList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"导入数据：",prop:"classifyId"}},[r("el-upload",{staticStyle:{display:"inline-block",margin:"0 10px"},attrs:{action:e.$BASE_URL+"/exam/backend/question/upload","on-success":e.uploadSuccess,headers:e.headers,data:e.importData,"show-file-list":!1}},[e.importData.classifyId?r("el-button",{attrs:{icon:"el-icon-upload",type:"success"}},[e._v("导入数据")]):r("span",[e._v("请选择所属分类")])],1)],1)],1)],1)],1)])},n=[],s=r("1da1"),i=r("5530"),o=(r("96cf"),r("a434"),r("159b"),r("4e82"),r("f477")),l=r("9f0d"),c=r("7539"),u=r("0c3f"),f=r("85b6"),d=r("2f62"),p=(r("3e8f"),{components:{userSelect:l["a"],krUpload:f["a"]},props:{allClassifyTypeList:{type:Array,default:function(){return[]}}},data:function(){return{dictUtils:o["a"],visible:!1,data:null,subjective:!1,showIsTianKong:!0,headers:{},importData:{paperType:1,classifyId:""},difficultyLevelOptions:[{value:0,label:"简单"},{value:1,label:"一般"},{value:2,label:"较难"},{value:3,label:"很难"}],form:new c["a"],rules:{type:{required:!0,message:"请选择试题类型",trigger:"blur"},classifyId:{required:!0,message:"请选择所属分类",trigger:"blur"},content:{required:!0,message:"请输入题目内容",trigger:"blur"}},method:"",size:""}},computed:Object(i["a"])({},Object(d["c"])({user:function(e){return e.user.user}})),watch:{"form.fullFlag":{handler:function(e){0==e&&(this.form.notifyRecordIds=[])}}},created:function(){},mounted:function(){this.headers.token=this.user.token},methods:{uploadSuccess:function(e){0==e.code?(this.$message.success("导入成功"),this.close(),this.$parent.$refs.table.init()):this.$message.error("导入失败"+e.msg)},init:function(){this.visible=!0,this.importData={paperType:1,classifyId:null}},handleAdd:function(){this.form.answers.push({analysis:"",content:"",correct:0,questionId:null,sort:1})},removeItem:function(e){this.form.answers.splice(e,1)},close:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.method="",e.visible=!1;case 2:case"end":return t.stop()}}),t)})))()},typeChange:function(e){switch(e){case 0:case 1:case 2:this.subjective=!0,this.showIsTianKong=!0;break;case 3:this.subjective=!1,this.showIsTianKong=!0;break;case 4:this.subjective=!0,this.showIsTianKong=!1;break}},validForm:function(){var e=this;if(0===this.form.type||1===this.form.type||2===this.form.type||4===this.form.type){var t=0;if(this.form.answers.forEach((function(e){e.content||(t+=1)})),t>0)return void this.$message({message:"不允许有空的选项内容",type:"warning"})}var r=0;if(this.form.answers.forEach((function(e){e.correct&&e.content&&(r+=1)})),0===this.form.type){if(r<1)return void this.$message({message:"单选题必须有一个答案",type:"warning"});if(r>1)return void this.$message({message:"单选题答案只能有一个",type:"warning"})}if(1===this.form.type&&r<2)this.$message({message:"多选题至少要有两个正确答案！",type:"warning"});else if(2!==this.form.type||1===r){if(3===this.form.type&&(this.form.answers=[]),4===this.form.type){this.form.answers.forEach((function(e){e.analysis="",e.correct=1}));var a=0;if(this.form.answers.forEach((function(e){e.content&&(a+=1)})),a<1)return void this.$message({message:"填空题至少有一个答案",type:"warning"});var n=0;if(this.form.answers.forEach((function(e){e.content.indexOf("\n")>0&&(n+=1)})),n>0)return void this.$message({message:"填空题答案不允许有换行符",type:"warning"})}console.log(this.form),this.form.answers.forEach((function(e,t){e.sort=t+1})),this.$refs.form.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=12;break}return t.next=3,u["a"].saveQuestion(e.form);case 3:if(a=t.sent,n=a.data,0==n.code){t.next=7;break}return t.abrupt("return",e.$message.error(n.msg));case 7:e.$message.success(n.msg),e.$parent.$refs.table.init(),e.close(),t.next=13;break;case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}else this.$message({message:"判断题只能有一个正确项！",type:"warning"})},formValidated:function(e,t,r){console.log(e,t,r)},getDictList:function(e){return o["a"].getDictList(e)}}}),m=p,h=(r("36ab"),r("3344"),r("2877")),y=Object(h["a"])(m,a,n,!1,null,"2263b972",null);t["default"]=y.exports},"1fce":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:"复制考试",width:"50%"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[r("div",{staticClass:"form-page"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"10em"},on:{validate:e.formValidated}},[r("el-form-item",{attrs:{label:"考试名称:",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入考试名称",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"截止时间：",prop:"expirationTime"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{"picker-options":e.pickerOptions,align:"right","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择截止时间"},model:{value:e.form.expirationTime,callback:function(t){e.$set(e.form,"expirationTime",t)},expression:"form.expirationTime"}})],1)],1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.close}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.validForm}},[e._v("确 定")])],1)])},n=[],s=r("1da1"),i=(r("96cf"),r("b0c0"),r("159b"),r("07ac"),r("0c3f")),o={data:function(){return{rules:{name:{required:!0,message:"请输入考试名称",trigger:"blur"},expirationTime:{required:!0,message:"请选择截止时间",trigger:"blur"}},visible:!1,form:{},defaultTreeList:[],selectedList:[],allUserMap:{},allUserList:[],pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}}}},created:function(){this.getAllUser()},methods:{close:function(){this.visible=!1},init:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.visible=!0,t.selectedList=[],r.next=4,i["a"].getPaperDetailById({id:e});case 4:a=r.sent,t.form=a.data.data,t.form.name+="-复制",t.form.expirationTime="",t.form.questions.forEach((function(e){e.id=e.questionId,e.paperId=null})),t.form.authorities.forEach((function(e){e.paperId=null,e.id=null})),t.form.status=0,t.form.id=null;case 12:case"end":return r.stop()}}),r)})))()},validForm:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"].savePaper(e.form);case 2:if(r=t.sent,a=r.data,0==a.code){t.next=6;break}return t.abrupt("return",e.$message.error(a.msg));case 6:e.$message.success(a.msg),e.$parent.$refs.table.init(),e.close();case 9:case"end":return t.stop()}}),t)})))()},formValidated:function(e,t,r){console.log(e,t,r)},getAllUser:function(){this.allUserMap=JSON.parse(localStorage.getItem("allUser")),this.allUserList=Object.values(JSON.parse(localStorage.getItem("allUser")))}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,n,!1,null,"a902f534",null);t["default"]=u.exports},"2c3e":function(e,t,r){},"2cc7":function(e,t,r){},"2df2":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"notification"},[r("div",{staticClass:"content-header"},[r("el-form",{ref:"elForm",staticClass:"filter-form",attrs:{inline:!0,model:e.searchForm}},[r("el-form-item",[r("el-select",{attrs:{placeholder:"开放权限"},model:{value:e.searchForm.authorityType,callback:function(t){e.$set(e.searchForm,"authorityType",t)},expression:"searchForm.authorityType"}},e._l(e.authorityTypeOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"截止时间"}},[r("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dateOption,callback:function(t){e.dateOption=t},expression:"dateOption"}})],1),r("el-form-item",[r("el-select",{attrs:{placeholder:"试卷状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(e.statusOptions,(function(e){return r("el-option",{key:e.vlaue,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",[r("el-input",{attrs:{placeholder:"考试名称",clearable:""},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.doSearch}},[e._v("查询")]),r("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:e.resetParams}},[e._v("重置")])],1)],1)],1),r("div",{staticClass:"table"},[r("kr-table",{ref:"table",attrs:{columns:e.columns,fetchFunc:e.getList,searchParams:e.searchForm},on:{"selection-change":e.handleSelectionChange}},[r("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.addOrEdit("add")}}},[e._v("新增考试")])],1)])],1),r("formDialog",{ref:"form",attrs:{allClassifyTypeList:e.allClassifyTypeList}}),r("exportDialog",{ref:"export",attrs:{allClassifyTypeList:e.allClassifyTypeList}}),r("copyDialog",{ref:"copy"})],1)},n=[],s=r("1da1"),i=r("5530"),o=(r("96cf"),r("b0c0"),r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("ac1f"),r("1276"),r("159b"),r("d81d"),r("a098")),l=r("1b64"),c=r("0c3f"),u=r("1fce"),f=r("2f62"),d={name:"sys-notification",components:{formDialog:o["default"],exportDialog:l["default"],copyDialog:u["default"]},props:{},data:function(){this.$createElement;var e=this;return{headers:{token:""},dateOption:[],importData:{},searchForm:{ascs:"",authorityType:null,current:1,descs:"create_time",endExpirationTime:null,keyword:"",paperType:1,size:20,startExpirationTime:null,status:null},authorityTypeOptions:[{value:null,label:"全部"},{value:0,label:"完全公开"},{value:1,label:"部门开放"},{value:2,label:"指定人员"}],selectedRows:[],total:100,rows:[],columns:[{prop:"name",label:"试卷名称",render:function(e,t){return e("div",{style:"color:var(--defaultTheme)"},[t.name])}},{prop:"authorityType",label:"开放权限",align:"center",width:200,sortable:!0,render:function(e,t){return e("div",[0===t.authorityType&&e("el-tag",{attrs:{effect:"dark"}},["完全公开"]),1===t.authorityType&&e("el-tag",{attrs:{effect:"dark",type:"success"}},["部门开放"]),2===t.authorityType&&e("el-tag",{attrs:{effect:"dark",color:"rgb(128,7,183)",type:"info"}},["指定人员"])])}},{prop:"limitCount",label:"限考次数",align:"center",width:200,sortable:!0,render:function(e,t){return e("div",[0===t.limitCount&&e("el-tag",{attrs:{effect:"dark"}},["无限制"]),0!==t.limitCount&&t.limitCount])}},{prop:"totalScore",label:"试卷总分",align:"center",width:200,sortable:!0,render:function(e,t){return e("div",[t.totalScore])}},{prop:"qualifyScore",label:"及格线",align:"center",width:200,sortable:!0,render:function(e,t){return e("div",[t.qualifyScore])}},{prop:"expirationTime",label:"截止时间",align:"center",width:200,sortable:!0,render:function(e,t){return e("div",[t.expirationTime])}},{prop:"status",label:"考试状态",align:"center",width:200,sortable:!0,render:function(t,r){return t("div",[0===r.status&&t("el-tag",{attrs:{effect:"dark"}},["未开放"]),0!==r.status&&1===r.status&&!e.isGuoQi(r)&&t("el-tag",{attrs:{effect:"dark",type:"success"}},["开放考试"]),0!==r.status&&(2===r.status||e.isGuoQi(r))&&t("el-tag",{attrs:{effect:"dark",type:"warning"}},["考试结束"])])}},{prop:"createTime",label:"创建时间",width:200,align:"center",sortable:!0},{label:"操作",headerAlign:"center",prop:"ffff",width:200,fixed:"right",align:"center",render:function(t,r){return t("div",[t("el-button",{on:{click:function(){return e.paperFenxi(r)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["考试分析"]),0===r.status&&t("el-button",{on:{click:function(){return e.openPaper(r)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["开放试卷"]),1===r.status&&!e.isGuoQi(r)&&t("el-button",{on:{click:function(){return e.closePaper(r)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["结束试卷"]),t("el-button",{on:{click:function(){return e.addOrEdit("view",r)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["查看"]),t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-copy",type:"text"},on:{click:function(){return e.copy(r.id)}}},["复制"]),0===r.status&&t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-tianxie",type:"text"},on:{click:function(){return e.addOrEdit("edit",r)}}},["编辑"]),0===r.status&&t("el-button",{attrs:{size:e.size,icon:" kr-shanchu krIconfont",type:"text"},on:{click:function(){return e.del(r)}},style:"color:red"},["删除"])])}}],showDetail:!1,allClassifyTypeMap:{},allClassifyTypeList:[],allClassifyTypeListAndAll:[],questionTypeOptions:[{value:null,label:"全部题型"},{value:0,label:"单选题"},{value:1,label:"多选题"},{value:2,label:"判断题"},{value:3,label:"简答题"},{value:4,label:"填空题"}],statusOptions:[{value:null,label:"全部"},{value:0,label:"未开放"},{value:1,label:"开放考试"},{value:2,label:"考试结束"}]}},computed:Object(i["a"])(Object(i["a"])({},Object(f["c"])({size:function(e){return e.config.defaultSize},user:function(e){return e.user.user}})),{},{getList:function(){return c["a"].getPaperlist}}),watch:{},created:function(){this.getQuestionClassifyType()},mounted:function(){this.headers.token=this.user.token},methods:{exportHandle:function(){this.$refs.export.init()},downloadTemplate:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].downloadTemplate({paperType:1});case 2:r=e.sent,a=document.createElement("a"),a.href=window.URL.createObjectURL(new Blob([r.data],{type:"application/octet-stream"})),a.target="_blank",n=null===(t=r.headers["content-disposition"])||void 0===t?void 0:t.split("=")[1],a.download=decodeURI(n),document.body.appendChild(a),a.click(),document.body.removeChild(a);case 11:case"end":return e.stop()}}),e)})))()},uploadSuccess:function(e){0==e.code?this.$message.success(e.msg):this.$message.error(e.msg),this.doSearch()},paperFenxi:function(e){this.$router.push({path:"/pages/exam/kaoshi/shijuanguanli/kaoshifenxi",query:{id:e.id}})},getQuestionClassifyType:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].list({ascs:"",classifyType:1,current:1,descs:"",keyword:"",size:9999});case 2:if(n=t.sent,s=n.data,0==s.code){t.next=6;break}return t.abrupt("return",e.$message.error(s.msg));case 6:e.allClassifyTypeList=null===s||void 0===s||null===(r=s.data)||void 0===r?void 0:r.records,e.allClassifyTypeListAndAll=JSON.parse(JSON.stringify(e.allClassifyTypeList)),e.allClassifyTypeListAndAll.unshift({id:null,name:"全部分类"}),null===s||void 0===s||null===(a=s.data)||void 0===a||a.records.forEach((function(t){var r=t.id;e.allClassifyTypeMap[r]=t.name}));case 10:case"end":return t.stop()}}),t)})))()},isGuoQi:function(e){return!((new Date).getTime()<new Date(e.expirationTime).getTime())},resetParams:function(){this.searchForm.keyword="",this.searchForm.authorityType=null,this.searchForm.status=null,this.dateOption=[],this.doSearch()},doSearch:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.searchForm.startExpirationTime=e.dateOption[0],e.searchForm.endExpirationTime=e.dateOption[1],e.$refs.table.init();case 3:case"end":return t.stop()}}),t)})))()},openPaper:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t.isGuoQi(e)){r.next=3;break}return t.$message({type:"error",message:"该考试已过期，请调整截止时间!"}),r.abrupt("return",!1);case 3:return r.next=5,c["a"].openPaperById({id:e.id});case 5:if(a=r.sent,n=a.data,0==n.code){r.next=9;break}return r.abrupt("return",t.$message.error(n.msg));case 9:t.$message({type:"success",message:"打开成功!"}),t.doSearch();case 11:case"end":return r.stop()}}),r)})))()},closePaper:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,c["a"].closePaperById({id:e.id});case 2:if(a=r.sent,n=a.data,0==n.code){r.next=6;break}return r.abrupt("return",t.$message.error(n.msg));case 6:t.$message({type:"success",message:"结束成功!"}),t.doSearch();case 8:case"end":return r.stop()}}),r)})))()},addOrEdit:function(e,t){this.$refs.form.init(e,t)},copy:function(e){this.$refs.copy.init(e)},handleSelectionChange:function(e){this.selectedRows=e},del:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e instanceof Array||(e=[e]),0!=e.length){r.next=3;break}return r.abrupt("return",t.$message.error("请选择需要删除的项!"));case 3:t.$confirm("此操作将永久删除所选, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.map((function(e){return e.id})),r.next=3,c["a"].deletePaperById({id:a});case 3:if(n=r.sent,s=n.data,0==s.code){r.next=7;break}return r.abrupt("return",t.$message.error(s.msg));case 7:t.$message({type:"success",message:"删除成功!"}),t.doSearch();case 9:case"end":return r.stop()}}),r)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 4:case"end":return r.stop()}}),r)})))()}}},p=d,m=(r("14a7"),r("2877")),h=Object(m["a"])(p,a,n,!1,null,"ab8e5c90",null);t["default"]=h.exports},3344:function(e,t,r){"use strict";r("2c3e")},"36ab":function(e,t,r){"use strict";r("2cc7")},"3e8f":function(e,t){},"4f4f":function(e,t,r){}}]);