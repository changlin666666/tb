(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20660a86","chunk-13ad6fd8"],{4112:function(e,t,r){},"5f87":function(e,t,r){"use strict";r("4112")},6512:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"60%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"140px",rules:e.rules}},[r("el-form-item",{attrs:{label:"任务名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请填写任务名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"任务类型",prop:"jobType"}},[r("el-select",{staticClass:"wid100",attrs:{placeholder:"请选择任务类型"},model:{value:e.form.jobType,callback:function(t){e.$set(e.form,"jobType",t)},expression:"form.jobType"}},e._l(e.typeList,(function(e){return r("el-option",{key:e.code,attrs:{label:e.value,value:e.code}})})),1)],1),e.form.jobType%2==0?r("el-form-item",{attrs:{label:"任务路径",prop:"jobPath"}},[r("el-input",{attrs:{placeholder:"类全名或者脚本文件路径"},model:{value:e.form.jobPath,callback:function(t){e.$set(e.form,"jobPath",t)},expression:"form.jobPath"}})],1):r("el-form-item",{attrs:{label:"脚本内容",prop:"scriptContent"}},[r("el-input",{attrs:{placeholder:"请填写脚本内容"},model:{value:e.form.scriptContent,callback:function(t){e.$set(e.form,"scriptContent",t)},expression:"form.scriptContent"}})],1),r("el-form-item",{attrs:{label:"任务组",prop:"group"}},[r("el-input",{attrs:{placeholder:"请填写任务组"},model:{value:e.form.group,callback:function(t){e.$set(e.form,"group",t)},expression:"form.group"}})],1),r("el-form-item",{attrs:{label:"定时规则类型",prop:"triggerType"}},[r("el-select",{staticClass:"wid100",attrs:{placeholder:"请选择定时规则类型"},model:{value:e.form.triggerType,callback:function(t){e.$set(e.form,"triggerType",t)},expression:"form.triggerType"}},[r("el-option",{attrs:{label:"cron表达式",value:"0"}}),r("el-option",{attrs:{label:"固定间隔和次数",value:"1"}})],1)],1),"0"===e.form.triggerType?r("el-form-item",{attrs:{label:"corn表达式",prop:"cronExpression"}},[r("el-input",{staticClass:"dialogcron",model:{value:e.form.cronExpression,callback:function(t){e.$set(e.form,"cronExpression",t)},expression:"form.cronExpression"}}),r("el-button",{on:{click:e.clickCron}},[e._v("设置")])],1):e._e(),1==e.form.triggerType?r("el-form-item",{staticClass:"half",attrs:{label:"重复次数",prop:"repeatCount"}},[r("el-input",{model:{value:e.form.repeatCount,callback:function(t){e.$set(e.form,"repeatCount",e._n(t))},expression:"form.repeatCount"}})],1):e._e(),1==e.form.triggerType?r("el-form-item",{staticClass:"half",attrs:{label:"重复间隔毫秒数",prop:"repeatInterval"}},[r("el-input",{model:{value:e.form.repeatInterval,callback:function(t){e.$set(e.form,"repeatInterval",e._n(t))},expression:"form.repeatInterval"}})],1):e._e(),r("el-form-item",{attrs:{label:"描述",prop:"description"}},[r("el-input",{attrs:{placeholder:"请填写任务描述"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.clickSub}},[e._v("确 定")])],1),r("cron",{ref:"cron",on:{onFinish:e.oncronFinish}})],1)},n=[],a=r("1da1"),i=(r("96cf"),r("8771")),s=r("7dca"),l=(r("f477"),{data:function(){var e=this,t=function(e,t,r){t<6e4?r(new Error("必须大于一分钟")):r()},r=function(t,r,o){e.form.jobType%2!=0||r?o():o(new Error("请填写任务路径"))},o=function(t,r,o){e.form.jobType%2==0||r?o():o(new Error("请填写脚本内容"))};return{form:{name:"",cronExpression:"",description:"",group:"",scriptContent:"",triggerType:"",repeatCount:"",repeatInterval:"",jobType:"",jobPath:""},dialogVisible:!1,title:"",type:"",rules:{name:[{required:!0,message:"请输入任务名称",trigger:"blur"}],jobType:[{required:!0,message:"请选择任务类型",trigger:"change"}],group:[{required:!0,message:"请填写任务组",trigger:"blur"}],triggerType:[{required:!0,message:"请选择定时规则类型",trigger:"change"}],repeatCount:[{required:!0,message:"请输入重复次数",trigger:"blur"},{type:"integer",message:"请输入数字",trigger:"blur"}],repeatInterval:[{type:"number",message:"请输入数字",trigger:"blur"},{validator:t,trigger:"blur"}],jobPath:[{validator:r,trigger:"blur"}],scriptContent:[{validator:o,trigger:"blur"}]}}},components:{cron:i["default"]},computed:{typeList:function(){return[{code:"0",value:"java方法"},{code:"1",value:"SQL脚本"},{code:"2",value:"SQL脚本文件"},{code:"3",value:"LINUX脚本"},{code:"4",value:"LINUX脚本文件"},{code:"5",value:"WINDOWS脚本"},{code:"6",value:"WINDOWS脚本文件"},{code:"7",value:"JS脚本"},{code:"8",value:"JS脚本文件"},{code:"9",value:"python脚本"},{code:"10",value:"python脚本文件"}]}},methods:{initForm:function(e,t){var r=this;this.type=e,this.title="add"==e?"新增":"编辑",this.dialogVisible=!0,this.$nextTick((function(){r.$refs.form.resetFields(),"add"!=e&&(r.form=JSON.parse(JSON.stringify(t)))}))},clickCron:function(){"add"==this.type?this.$refs.cron.init("add"):this.$refs.cron.init("edit",this.form.cronExpression)},oncronFinish:function(e){this.form.cronExpression=e},clickSub:function(){var e=this;try{this.$refs.form.validate(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var o,n,a,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=20;break}if(o=JSON.parse(JSON.stringify(e.form)),1==o.triggerType&&delete o.cronExpression,0!==o.jobType){t.next=10;break}return t.next=6,s["a"].existsClass({className:o.jobPath});case 6:if(n=t.sent,a=n.data,0==a.code){t.next=10;break}return t.abrupt("return");case 10:if(!(o.jobType>0&&o.jobType%2==0)){t.next=17;break}return t.next=13,s["a"].existsJobPath({jobPath:o.jobPath});case 13:if(i=t.sent,l=i.data,0==l.code){t.next=17;break}return t.abrupt("return");case 17:"add"==e.type?e.postAdd(o):e.postEdit(o),t.next=21;break;case 20:return t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(t){this.$message.error(t)}},postAdd:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var o,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.status="0",r.next=3,s["a"].add(e);case 3:if(o=r.sent,n=o.data,0==n.code){r.next=8;break}return t.$message.error(n.msg),r.abrupt("return");case 8:t.$message.success(n.data),t.$parent.$refs.table.init(),t.dialogVisible=!1;case 11:case"end":return r.stop()}}),r)})))()},postEdit:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var o,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.nearTime=null,r.next=3,s["a"].edit(e);case 3:if(o=r.sent,n=o.data,0==n.code){r.next=8;break}return t.$message.error(n.msg),r.abrupt("return");case 8:t.$message.success(n.data),t.$parent.$refs.table.init(),t.dialogVisible=!1;case 11:case"end":return r.stop()}}),r)})))()}}}),c=l,u=(r("5f87"),r("2877")),p=Object(u["a"])(c,o,n,!1,null,"62bb1474",null);t["default"]=p.exports},"7dca":function(e,t,r){"use strict";var o=r("7bc1");t["a"]={list:function(e){return o["a"].post("/task/list",e)},add:function(e){return o["a"].post("/task/add",e)},edit:function(e){return o["a"].post("/task/edit",e)},delete:function(e){return o["a"].get("/task/delete",e)},stop:function(e){return o["a"].post("/task/stop?id="+e.id,e)},resume:function(e){return o["a"].post("/task/resume?id="+e.id,e)},startNow:function(e){return o["a"].post("/task/startNow?id="+e.id,e)},existsClass:function(e){return o["a"].get("/task/existsClass",e)},existsJobPath:function(e){return o["a"].get("/task/existsJobPath",e)},isOver:function(e){return o["a"].get("/task/get/variables",e)},history:function(e){return o["a"].get("/task/history",e)}}},8771:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"提示",visible:e.visidible,width:"50%","append-to-body":""},on:{"update:visible":function(t){e.visidible=t}}},[r("KrCron",{attrs:{value:e.crvalue},model:{value:e.cronExpre,callback:function(t){e.cronExpre=t},expression:"cronExpre"}}),r("div",{staticStyle:{"margin-top":"10px"}},[r("span",[e._v("cron表达式：")]),r("el-input",{staticClass:"croninput",model:{value:e.cronExpre,callback:function(t){e.cronExpre=t},expression:"cronExpre"}})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.visidible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.clickCronOK}},[e._v("确 定")])],1)],1)},n=[],a={data:function(){return{visidible:!1,cronExpre:"",crvalue:""}},methods:{init:function(e,t){this.visidible=!0,"add"==e?this.cronExpre="":(this.cronExpre=t,this.crvalue=t)},clickCronOK:function(){this.visidible=!1,this.$emit("onFinish",this.cronExpre)}}},i=a,s=(r("b474"),r("2877")),l=Object(s["a"])(i,o,n,!1,null,"4b4a355f",null);t["default"]=l.exports},b474:function(e,t,r){"use strict";r("deb4")},deb4:function(e,t,r){}}]);