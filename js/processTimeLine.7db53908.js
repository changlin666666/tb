(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["processTimeLine"],{"32a9":function(t,e,n){"use strict";n("6bee")},4446:function(t,e,n){},"446c":function(t,e,n){"use strict";n("4446")},"6bee":function(t,e,n){},"77be":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("KrPanel",{attrs:{title:"流程详情"}},[t.processList.length?n("kr-time-line",[n("kr-time-line-item",{attrs:{icon:"krIconfont kr-icon_fabu",text:"发起",success:""}},[n("div",{staticClass:"title"},[t._v("发起申请")]),n("div",{staticClass:"user-box"},[n("img",{staticClass:"user-img",attrs:{src:t.getAvatar(t.processList[0].startProcessUser),alt:""}}),n("div",{staticClass:"user-name"},[t._v(" "+t._s(t.processList[0].startProcessUser.name)+" ")])]),n("div",{staticClass:"m-t-20 info-color"},[t._v(" 发起【"+t._s(t.processList[0].processName)+"】 "),n("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$dayjs(t.processList[0].startTime).format("YYYY-MM-DD HH:mm:ss")))])]),t.processList[0].startCopyUser&&t.processList[0].startCopyUser.length?[n("div",{staticClass:"m-t-20"},[t._v("抄送")]),n("div",{staticClass:"m-t-20 copy-list"},t._l(t.processList[0].startCopyUser,(function(e,s){return n("div",{key:s,staticClass:"copy-user"},[n("div",[n("img",{staticClass:"user-img",attrs:{src:t.getAvatar(e),alt:""}})]),n("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.name))])])})),0)]:t._e()],2),t._l(t.processList,(function(e,s){return n("kr-time-line-item",{key:s,attrs:{icon:"krIconfont kr-shenhe",text:"审批",success:t.processList[s+1]&&null!==t.processList[s+1].id}},[n("div",{staticClass:"title"},[t._v(" "+t._s(e.name)+" ")]),e.multipleInstances?[[n("div",{staticClass:"m-t-20"},[t._v("会签已审核")]),t._l(e.assigneeUserVOS,(function(e,s){return n("div",{key:s,staticClass:"m-t-20",staticStyle:{"padding-left":"20px"}},[n("div",[n("div",{staticClass:"user-box"},[n("img",{staticClass:"user-img",attrs:{src:t.getAvatar(e.assigneeUser)}}),n("div",{staticClass:"user-name"},[t._v(" "+t._s(e.assigneeUser.name)+" ")])]),n("div",{staticClass:"info-color m-t-20"},[n("span",{class:t.getType(e.state)},[t._v(t._s(t.getState(e.state)))]),n("span",{staticStyle:{"padding-left":"10px"}},[t._v(t._s(t.$dayjs(e.assigneeTime).format("YYYY-MM-DD HH:mm:ss")))])]),e.comments&&e.comments.length&&e.comments[0].fullMessage?n("div",{staticClass:"comment m-t-20"},[t._v(" 审核意见："+t._s(e.comments[0].fullMessage)+" ")]):t._e(),e.copyUser&&e.copyUser.length?[n("div",{staticClass:"m-t-20"},[t._v("抄送")]),n("div",{staticClass:"m-t-20 copy-list"},t._l(e.copyUser,(function(e,s){return n("div",{key:s,staticClass:"copy-user"},[n("div",[n("img",{staticClass:"user-img",attrs:{src:t.getAvatar(e),alt:""}})]),n("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.name))])])})),0)]:t._e()],2)])}))],1===e.processStatus?[n("div",{staticClass:"m-t-20"},[t._v("会签待审批")]),n("div",{staticClass:"m-t-20 user-list-flex"},[t._l(e.candidateUsers,(function(s,r){return[t.isAssignee(e,s)?n("div",{key:r,staticClass:"user-box-flex"},[n("div",[n("img",{staticClass:"user-img",attrs:{src:t.getAvatar(s),alt:""}})]),n("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(s.name))])]):t._e()]}))],2)]:t._e()]:[e.assigneeUser?[n("div",{staticClass:"user-box"},[n("img",{staticClass:"user-img",attrs:{src:t.getAvatar(e.assigneeUser?e.assigneeUser:{}),alt:""}}),n("div",{staticClass:"user-name"},[t._v(" "+t._s(e.assigneeUser.name)+" ")])]),n("div",{staticClass:"info-color m-t-20"},[n("span",{class:t.getType(e.state)},[t._v(t._s(t.getState(e.state)))]),n("span",{staticStyle:{"padding-left":"10px"}},[t._v(t._s(e.endTime?t.$dayjs(e.endTime).format("YYYY-MM-DD HH:mm:ss"):""))])]),e.comment?n("div",{staticClass:"comment m-t-20"},[t._v(" 审核意见："+t._s(e.comment)+" ")]):t._e(),e.copyUser&&e.copyUser.length?[n("div",{staticClass:"m-t-20"},[t._v("抄送")]),n("div",{staticClass:"m-t-20 copy-list"},t._l(e.copyUser,(function(e,s){return n("div",{key:s,staticClass:"copy-user"},[n("div",[n("img",{staticClass:"user-img",attrs:{src:t.getAvatar(e),alt:""}})]),n("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.name))])])})),0)]:t._e()]:[n("div",[t._v("待审批")]),e.candidateUsers&&e.candidateUsers.length?n("div",{staticClass:"m-t-20 user-list-flex"},t._l(e.candidateUsers,(function(e,s){return n("div",{key:s,staticClass:"user-box-flex"},[n("div",[n("img",{staticClass:"user-img",attrs:{src:t.getAvatar(e),alt:""}})]),n("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.name))])])})),0):t._e()]]],2)}))],2):t._e()],1)},r=[],i=(n("d81d"),n("b0c0"),n("a15b"),n("c740"),n("0ac7")),a=n.n(i),o={name:"prcoessTimeLine",props:{process:{type:Array,default:function(){return[]}}},computed:{processList:function(){for(var t=this.process,e=function(e){t[e].comments&&t[e].comments.map((function(n){n.taskId===t[e].id&&(t[e].comment=n.message)}))},n=0;n<t.length;n++)e(n);return t}},data:function(){return{defaultAvatar:a.a}},methods:{getState:function(t){var e=["等待审核","审核通过","已拒绝","驳回","撤销"];return e[t]},getType:function(t){var e=["","success","info","danger","warning"];return e[t]},getIcon:function(){var t=0,e=["kr-daichuli primary","kr-yitongguo success","kr-yijujue danger"];return this.processList.length&&(t=this.processList[this.processList.length-1].state),t=null==t?0:t,e[t]},getCopyUser:function(t){var e=t.map((function(t){return t.name}));return e.join(",")},getAvatar:function(t){return t&&t.avatar?this.$BASE_URL+"/source/download?id="+t.avatar:this.defaultAvatar},isAssignee:function(t,e){return-1===t.assigneeUserVOS.findIndex((function(t){return t.assigneeUser.id===e.id}))}}},c=o,u=(n("32a9"),n("2877")),d=Object(u["a"])(c,s,r,!1,null,"40bc30b1",null);e["default"]=d.exports},"83bb":function(t,e,n){"use strict";n.d(e,"I",(function(){return r})),n.d(e,"w",(function(){return i})),n.d(e,"l",(function(){return a})),n.d(e,"o",(function(){return o})),n.d(e,"K",(function(){return c})),n.d(e,"F",(function(){return u})),n.d(e,"g",(function(){return d})),n.d(e,"p",(function(){return f})),n.d(e,"L",(function(){return l})),n.d(e,"f",(function(){return p})),n.d(e,"G",(function(){return m})),n.d(e,"z",(function(){return g})),n.d(e,"A",(function(){return v})),n.d(e,"r",(function(){return y})),n.d(e,"B",(function(){return h})),n.d(e,"J",(function(){return _})),n.d(e,"b",(function(){return C})),n.d(e,"y",(function(){return L})),n.d(e,"t",(function(){return k})),n.d(e,"N",(function(){return x})),n.d(e,"D",(function(){return b})),n.d(e,"i",(function(){return w})),n.d(e,"n",(function(){return U})),n.d(e,"u",(function(){return S})),n.d(e,"c",(function(){return D})),n.d(e,"j",(function(){return j})),n.d(e,"O",(function(){return A})),n.d(e,"q",(function(){return O})),n.d(e,"a",(function(){return E})),n.d(e,"h",(function(){return I})),n.d(e,"M",(function(){return T})),n.d(e,"e",(function(){return M})),n.d(e,"Q",(function(){return Y})),n.d(e,"m",(function(){return P})),n.d(e,"C",(function(){return R})),n.d(e,"x",(function(){return F})),n.d(e,"d",(function(){return B})),n.d(e,"P",(function(){return N})),n.d(e,"k",(function(){return $})),n.d(e,"v",(function(){return H})),n.d(e,"s",(function(){return K})),n.d(e,"E",(function(){return J})),n.d(e,"H",(function(){return V}));var s=n("7bc1"),r=function(t){return s["a"].post("/processDefinition/model/save",t)},i=function(t){return s["a"].post("/processDefinition/model/list",t)},a=function(t){return s["a"].post("/processDefinition/model/delete",t,!0)},o=function(t){return s["a"].post("/processDefinition/deploy",t,!0)},c=function(t){return s["a"].post("/instance/start",t)},u=function(t){return s["a"].post("/task/todo/list",t)},d=function(t){return s["a"].post("/task/complete",t)},f=function(t){return s["a"].post("/task/end/task",t)},l=function(t){return s["a"].post("/task/turnTask",t)},p=function(t){return s["a"].post("/task/back/task",t)},m=function(t){return s["a"].post("/copy/insert",t)},g=function(t){return s["a"].post("/history/process/mys",t)},v=function(t){return s["a"].get("/task/get/nodeList",t)},y=function(t){return s["a"].post("/history/current/list",t)},h=function(t){return s["a"].get("/workflow/setting/list/processDefinitionId",t)},_=function(t){return s["a"].post("/workflow/setting/saveAll",t)},C=function(t){return s["a"].post("/workflow/draft/add",t)},L=function(t){return s["a"].get("/workflow/draft/list",t)},k=function(t){return s["a"].get("/workflow/draft/id?id="+t)},x=function(t){return s["a"].post("/workflow/draft/update",t)},b=function(t){return s["a"].post("/processDefinition/deployment",t)},w=function(t){return s["a"].post("/workflow/draft/delete",t,!0)},U=function(t){return s["a"].post("/instance/delete/processInstance/id",t,!0)},S=function(t){return s["a"].get("/actExtensionCondition",t)},D=function(t){return s["a"].post("/actExtensionCondition/add",t)},j=function(t){return s["a"].post("/actExtensionCondition/delete",t,!0)},A=function(t){return s["a"].post("/actExtensionCondition/update",t)},O=function(t){return s["a"].get("/actExtensionButton/list",t)},E=function(t){return s["a"].post("/actExtensionButton",t)},I=function(t){return s["a"].post("/actExtensionButton/delete",t,!0)},T=function(t){return s["a"].post("/actExtensionButton/update",t)},M=function(t){return s["a"].post("/actExtensionCategory/add",t)},Y=function(t){return s["a"].post("/actExtensionCategory/update",t)},P=function(t){return s["a"].post("/actExtensionCategory/delete",t,!0)},R=function(t){return s["a"].get("/actExtensionCategory/list",t)},F=function(t){return s["a"].get("/listener/list",t)},B=function(t){return s["a"].post("/listener/add",t)},N=function(t){return s["a"].post("/listener/update",t)},$=function(t){return s["a"].post("/listener/delete",t,!0)},H=function(t){return s["a"].get("/history/get/instance/id",t)},K=function(t){return s["a"].post("/copy/list",t)},J=function(t){return s["a"].post("/history/all/user",t)},V=function(t){return s["a"].post("/processDefinition/suspend/id",t,!0)}},afe6:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"task-container"},[n("div",{staticClass:"state"},[n("i",{staticClass:"krIconfont",class:t.getIcon(),staticStyle:{"font-size":"80px"}})]),n("kr-panel",{attrs:{title:t.startUser+"提交的"+t.processName}},[n("ProForm",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{data:t.formData,rules:t.remoteRules,value:t.dataMap,readOnly:!0,onlyLabel:!0}})],1),n("TimeLine",{staticStyle:{"margin-top":"20px"},attrs:{process:t.processList}})],1)},r=[],i=n("1da1"),a=n("b85c"),o=n("5530"),c=(n("96cf"),n("b0c0"),n("d81d"),n("a15b"),n("d48d")),u=n("83bb"),d=n("4152"),f=n("2f62"),l=n("77be"),p={components:{ProForm:c["default"],TimeLine:l["default"]},name:"processTimeLine",data:function(){return{id:"",processList:[],loading:!1,formData:{},initData:{},formSetList:[]}},computed:Object(o["a"])(Object(o["a"])({},Object(f["c"])({user:function(t){return t.user.user}})),{},{startUser:function(){return this.processList[0]&&this.processList[0].startProcessUser?this.processList[0].startProcessUser.name:""},processName:function(){return this.processList[0]?this.processList[0].processName:""},dataMap:function(){return this.processList[0]&&this.processList[0].dataMap?this.processList[0].dataMap:{}},remoteRules:function(){if(this.formData.rules&&this.formData.rules.length>0){var t,e=[],n=Object(a["a"])(this.formData.rules);try{for(n.s();!(t=n.n()).done;){var s=t.value,r={};r.field=s.field,r.control=[{value:s.value,way:s.way,rule:{operator:s.remoteAction,field:s.remoteField}}],e.push(r)}}catch(i){n.e(i)}finally{n.f()}return e}return[]}}),created:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.id=t.$route.params.id,t.loading=!0,e.next=4,t.getProcess();case 4:if(t.processList.length){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,t.getProcessFormSetList();case 8:t.formSetList.map((function(e){e.taskDefKey===t.processList[0].processVariables.FLOW_DATA_KEY.firstNodeId&&t.getFormConfig(e.formKey)})),t.loading=!1;case 10:case"end":return e.stop()}}),e)})))()},methods:{getProcessFormSetList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.formSetList=[],e.next=3,Object(u["B"])({processDefinitionKey:t.processList[0].definitionKey});case 3:n=e.sent,s=n.data,0===s.code&&(t.formSetList=s.data);case 6:case"end":return e.stop()}}),e)})))()},getFormConfig:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var s,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=3;break}return e.formData={},n.abrupt("return");case 3:return n.next=5,Object(d["b"])({id:t});case 5:s=n.sent,r=s.data,0===r.code&&(i=JSON.parse(r.data.structContent),e.formData=i);case 8:case"end":return n.stop()}}),n)})))()},getProcess:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["v"])({processInstanceId:t.id});case 2:n=e.sent,s=n.data,0===s.code&&(t.processList=s.data);case 5:case"end":return e.stop()}}),e)})))()},getState:function(t){var e=["等待审核","审核通过","审核终止","驳回","撤销"];return e[t]},getType:function(t){var e=["","success","info","danger","warning"];return e[t]},getIcon:function(){var t=0,e=["kr-daichuli primary","kr-yitongguo success","kr-yijujue danger"];return this.processList.length&&2===this.processList[this.processList.length-1].processStatus?e[1]:(this.processList.length&&(t=this.processList[this.processList.length-1].state),t=null==t?0:t,e[t])},getCopyUser:function(t){var e=t.map((function(t){return t.name}));return e.join(",")},getAvatar:function(t){return t&&t.avatar?this.$BASE_URL+"/source/download?id="+t.avatar:this.defaultAvatar}}},m=p,g=(n("446c"),n("2877")),v=Object(g["a"])(m,s,r,!1,null,"1437b7eb",null);e["default"]=v.exports}}]);