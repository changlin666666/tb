(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24117c30","chunk-0e6d02f2","chunk-2d0ea0e5"],{3521:function(e,t,r){"use strict";var n=r("7bc1");t["a"]={bindMenu:function(e){return n["a"].post("/sys/bind/bindMenu",e)},list:function(e){return n["a"].post("/sys/bind/queryBindMenus",e)},bindRole:function(e){return n["a"].post("/sys/bind/userBindRoles",e)}}},"3ffd":function(e,t,r){"use strict";r("92ae")},5275:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",{staticClass:"container"},[r("KrSearch",{attrs:{searchProps:e.searchProps}}),r("el-col",{staticClass:"content",attrs:{span:24}},[r("kr-table",{ref:"table",attrs:{columns:e.columns,rows:e.tableData,total:100,page:1,pageSize:20},on:{changeSize:e.changeSize,"selection-change":e.handleSelectionChange}},[r("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[r("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.add}},[e._v("新建岗位")]),r("el-button",{attrs:{icon:"el-icon-delete",type:"danger",plain:"",disabled:0==e.selection.length},on:{click:function(t){return e.del(e.selection)}}},[e._v("批量删除("+e._s(e.selection.length)+")")])],1)])],1),r("listForm",{ref:"listForm"}),r("AuthForm",{ref:"AuthForm",attrs:{treeData:e.treeData}})],1)},s=[],a=r("70e5"),i=r("8fbc"),o={components:{listForm:i["default"],AuthForm:a["default"]},data:function(e){this.$createElement;return{columns:[{prop:"name",label:"岗位名称"},{prop:"code",label:"岗位编码"},{prop:"type",sortable:!0,label:"岗位类型",formatter:function(e){return e.type}},{prop:"use",label:"是否可用",render:function(t,r){return t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949",value:r.use},on:{change:function(){return e.changeUse(r)}}})}},{prop:"sort",label:"排序"},{prop:"desc",label:"备注"},{fixed:"right",align:"right",width:300,render:function(t,r,n){return t("div",[t("el-button",{attrs:{icon:" kr-tianxie krIconfont",size:e.size,type:"text"},on:{click:function(){return e.edit(r,n)}}},["编辑"]),t("el-button",{attrs:{icon:"kr-shujuku1 krIconfont",size:e.size,type:"text"},on:{click:function(){return e.detail(r,n)}}},["查看"]),t("el-button",{attrs:{icon:"krIconfont kr-hezuohuobanmiyueguanli",size:e.size,type:"text"},on:{click:function(){return e.setRole(r,n)}}},["权限设置"]),t("el-button",{attrs:{icon:" kr-shanchu krIconfont",size:e.size,type:"text"},on:{click:function(){return e.del(r,n)}},style:"color:red"},["删除"])])}}],tableData:[{id:"1",name:"董事长",code:"test_dsz",type:"test_type1",use:!0,sort:1,desc:"测试1"},{id:"2",name:"总经理",code:"test_zjl",type:"test_type21",use:!0,sort:2,desc:"测试2"},{id:"3",name:"部门经理",code:"test_bmjl",type:"test_type3",use:!0,sort:3,desc:"测试3"},{id:"4",name:"员工",code:"test_yg",type:"test_type4",use:!0,sort:4,desc:"测试4"}],treeData:[{id:"1",name:"总公司",code:"test_zgs",type:"test_type1",level:1,use:!0,sort:1,desc:"测试1",parent:{id:"0"},children:[{id:"2",name:"总经办",code:"test_zjl",type:"test_type21",level:2,use:!0,sort:2,parent:{id:"1"},desc:"测试2",children:[{id:"14",name:"秘书",code:"test_zjl",type:"test_type21",level:3,use:!0,sort:2,parent:{id:"2"},desc:"测试2"}]},{id:"3",name:"财务部",code:"test_bmjl",type:"test_type3",level:2,use:!0,parent:{id:"1"},sort:3,desc:"测试3"},{id:"4",name:"市场部",code:"test_yg",type:"test_type4",level:2,use:!0,parent:{id:"1"},sort:4,desc:"测试4"}]},{id:"2",name:"分公司",code:"test_fgs",type:"test_type2",level:1,use:!0,sort:1,parent:{id:"0"},desc:"测试2",children:[]}],selection:[],size:"medium",searchProps:[{isShow:!0,type:"input",field:"name",value:"",model:"岗位名称"}]}},methods:{changeUse:function(e){e.use=!e.use},detail:function(e){this.$refs.listForm.init("view",e.id,e)},handleSelectionChange:function(e){this.selection=e},changeSize:function(e){this.size=e},add:function(){this.$refs.listForm.init("add")},edit:function(e){this.$refs.listForm.init("edit",e.id,e)},del:function(e){if(e instanceof Array||(e=[e]),0==e.length)return this.$message.error("请选择需要删除的项!");this.$confirm("确定要删除选择项？","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"error"}).then((function(){})).catch((function(e){e.type}))},setRole:function(e){this.$refs.AuthForm.init(e.id)}}},l=o,c=(r("3ffd"),r("2877")),u=Object(c["a"])(l,n,s,!1,null,"29552fa6",null);t["default"]=u.exports},"70e5":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:"权限分配",width:e.width},on:{"update:visible":function(t){e.visible=t},close:function(t){e.visible=!1}}},[r("el-form",{ref:"form",attrs:{size:"medium"}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",[r("kr-tree",{ref:"tree",staticClass:"tree",attrs:{data:e.treeData,props:e.treeProps,"node-key":e.nodeKey,"show-checkbox":"","default-expanded-keys":e.treeExpandData,"default-checked-keys":e.defaultKeys},on:{check:e.getChecked}})],1)],1)],1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),r("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},s=[],a=r("2909"),i=r("1da1"),o=r("b85c"),l=(r("96cf"),r("a9e3"),r("99af"),r("3521")),c=r("eb40"),u=r("0208");function d(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=Object(o["a"])(e);try{for(i.s();!(r=i.n()).done;){var l=r.value;n.push(l[s]),a>=t||l.children&&l.children.length>0&&(a++,d(l.children,t,n,a))}}catch(c){i.e(c)}finally{i.f()}}var f={props:{width:{type:String,default:"30%"},nodeKey:{type:String,default:"id"},level:{type:Number,default:1},type:{type:String,default:"role"}},data:function(){return{visible:!1,id:"",authList:[],defaultKeys:[],treeData:[],treeProps:{children:"children",label:"name",disabled:"disabled"}}},mounted:function(){this.getAuthTree()},computed:{treeExpandData:function(){var e=[];return d(this.treeData,this.level,e,this.nodeKey),e}},methods:{init:function(e){var t=this;this.id=e,this.visible=!0,this.$nextTick(Object(i["a"])(regeneratorRuntime.mark((function r(){var n,s,a,i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$refs.tree.$refs.tree.setCheckedKeys([]),n={},r.t0=t.type,r.next="role"===r.t0?5:"user"===r.t0?7:"post"===r.t0?9:"admin"===r.t0?11:13;break;case 5:return n.roleId=e,r.abrupt("break",14);case 7:return n.userId=e,r.abrupt("break",14);case 9:return n.postId=e,r.abrupt("break",14);case 11:return n.id=e,r.abrupt("break",14);case 13:return r.abrupt("break",14);case 14:if("admin"!=t.type){r.next=22;break}return r.next=17,c["a"].getMenus({id:e});case 17:s=r.sent,a=s.data,a.data.length>0&&(t.defaultKeys=a.data),r.next=27;break;case 22:return r.next=24,l["a"].list(n);case 24:i=r.sent,o=i.data,o.data.length>0&&(t.defaultKeys=o.data);case 27:case"end":return r.stop()}}),r)}))))},getAuthTree:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u["a"].getFilterMenu({flag:1});case 2:r=t.sent,n=r.data,e.treeData=n.data.children;case 5:case"end":return t.stop()}}),t)})))()},getChecked:function(e,t){this.authList=[].concat(Object(a["a"])(t.checkedKeys),Object(a["a"])(t.halfCheckedKeys))},submit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,r={menuIds:[].concat(Object(a["a"])(e.$refs.tree.getCheckedKeys()),Object(a["a"])(e.$refs.tree.getHalfCheckedKeys())),postId:null,roleId:null,userId:null},t.t0=e.type,t.next="role"===t.t0?5:"post"===t.t0?7:"user"===t.t0?9:11;break;case 5:return r.roleId=e.id,t.abrupt("break",12);case 7:return r.postId=e.id,t.abrupt("break",12);case 9:return r.userId=e.id,t.abrupt("break",12);case 11:return t.abrupt("break",12);case 12:if("admin"!=e.type){t.next=23;break}return t.next=15,c["a"].saveMenus({id:e.id,menuIds:[].concat(Object(a["a"])(e.$refs.tree.getCheckedKeys()),Object(a["a"])(e.$refs.tree.getHalfCheckedKeys()))});case 15:if(n=t.sent,s=n.data,0==s.code){t.next=19;break}return t.abrupt("return",e.$message.error(s.msg));case 19:e.$message.success(s.msg),e.visible=!1,t.next=31;break;case 23:return t.next=25,l["a"].bindMenu(r);case 25:if(i=t.sent,o=i.data,0==o.code){t.next=29;break}return t.abrupt("return",e.$message.error(o.msg));case 29:e.$message.success(o.msg),e.visible=!1;case 31:e.$emit("update"),t.next=37;break;case 34:t.prev=34,t.t1=t["catch"](0),e.$message.error(t.t1);case 37:case"end":return t.stop()}}),t,null,[[0,34]])})))()}}},p=f,m=r("2877"),b=Object(m["a"])(p,n,s,!1,null,null,null);t["default"]=b.exports},"8fbc":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:e.title,width:e.width},on:{"update:visible":function(t){e.visible=t},close:function(t){e.visible=!1}}},[r("el-form",{ref:"form",attrs:{"label-width":"120px",model:e.form,size:"medium",rules:e.rules,disabled:"view"===e.method}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"岗位名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入岗位名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"岗位编码",prop:"code"}},[r("el-input",{attrs:{placeholder:"请输入岗位编码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"岗位类型",prop:"type"}},[r("el-select",{staticStyle:{width:"100%"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(3,(function(e,t){return r("el-option",{key:t,attrs:{value:e,label:"类型"+e}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"是否可用",prop:"use"}},[r("el-radio-group",{model:{value:e.form.use,callback:function(t){e.$set(e.form,"use",t)},expression:"form.use"}},[r("el-radio-button",{attrs:{label:!0}},[e._v("是")]),r("el-radio-button",{attrs:{label:!1}},[e._v("否")])],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"是否可用",prop:"sort"}},[r("el-input-number",{attrs:{min:1,label:"排序"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"备注",prop:"desc"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),r("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},s=[],a={props:{width:{type:String,default:"50%"}},data:function(){return{visible:!1,method:"",form:{name:"",code:"",type:"",use:!0,sort:1,desc:""},rules:{type:[{required:!0,message:"岗位类型不能为空",trigger:"blur"}]},id:"",title:""}},methods:{init:function(e,t,r){var n=this;this.method=e,this.title="add"===e?"新建岗位":"view"===e?"查看岗位":"编辑岗位",this.id=t,this.visible=!0,this.$nextTick((function(){n.$refs.form.resetFields(),"add"!==e&&(n.form=JSON.parse(JSON.stringify(r)))}))},submit:function(){var e=this;try{this.$refs.form.validate((function(t){if(!t)return!1;e.$message.success("操作成功!"),e.visible=!1}))}catch(t){this.$message.error(t)}}}},i=a,o=r("2877"),l=Object(o["a"])(i,n,s,!1,null,null,null);t["default"]=l.exports},"92ae":function(e,t,r){},eb40:function(e,t,r){"use strict";var n=r("7bc1");t["a"]={save:function(e){return n["a"].post("/sys/roleAdmin/save",e)},detail:function(e){return n["a"].get("/sys/roleAdmin/queryById",e)},getMenus:function(e){return n["a"].get("/sys/roleAdmin/queryBindMenus",e)},list:function(e){return n["a"].post("/sys/roleAdmin/list",e)},del:function(e){return n["a"].get("/sys/roleAdmin/delete",e)},saveMenus:function(e){return n["a"].post("/sys/roleAdmin/bindMenu",e)}}}}]);