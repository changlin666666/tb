(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-526cbe4a"],{"00ca":function(e,t,n){},"2c8f":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"notification"},[n("div",{staticClass:"content-header"},[n("el-form",{ref:"elForm",staticClass:"filter-form",attrs:{inline:!0,model:e.searchForm}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"文章名称",clearable:""},model:{value:e.searchForm.title,callback:function(t){e.$set(e.searchForm,"title",t)},expression:"searchForm.title"}})],1),n("el-form-item",[n("kr-tree-select",{attrs:{data:e.menuIdOptions,props:e.defaultProps,nodeKey:"nodeIds"},on:{getValue:e.getValue},model:{value:e.searchForm.menuId,callback:function(t){e.$set(e.searchForm,"menuId",t)},expression:"searchForm.menuId"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.doSearch}},[e._v("查询")]),n("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:e.resetParams}},[e._v("重置")])],1)],1)],1),n("div",{staticClass:"table"},[n("kr-table",{ref:"table",attrs:{columns:e.columns,fetchFunc:e.getList,searchParams:e.searchForm},on:{"selection-change":e.handleSelectionChange}})],1),n("formDialog",{ref:"form",attrs:{imgCutOption:e.imgCutOption}})],1)},a=[],s=n("1da1"),i=n("5530"),c=(n("96cf"),n("d81d"),n("b0c0"),n("0b34")),o=n("038f"),u=n("f477"),d=n("2f62"),l={name:"sys-notification",components:{formDialog:c["default"]},props:{},data:function(){this.$createElement;var e=this;return{auditMessage:"",auditRow:{},dialogVisible:!1,imgCutOption:{boxWidth:920,boxHeight:520,originalGraph:!1,cutWidth:620,cutHeight:410},notiType:[],articleStatus:"",searchForm:{articleStatus:[-1],ascs:"",current:1,deptId:"",descs:"",menuId:"000",orgId:"",audit:1,size:20},selectedRows:[],total:100,rows:[],columns:[{prop:"title",label:"文章标题",render:function(e,t){return e("div",{style:"color:var(--defaultTheme)"},[t.title])}},{prop:"author",sortable:!0,label:"作者"},{prop:"publishTime",label:"发布时间",sortable:!0,width:"300"},{prop:"menuId",label:"菜单",sortable:!0,width:"300",render:function(t,n){return t("div",[e.menuOptions.map((function(e){if(e.nodeIds===n.menuId)return t("el-tag",[e.name])}))])}},{prop:"auditMessageJson",label:"审核意见",sortable:!0,width:"300",render:function(e,t){return e("div",[t.auditMessageJson&&JSON.parse(t.auditMessageJson)&&JSON.parse(t.auditMessageJson)[0]?JSON.parse(t.auditMessageJson)[0].auditMessage:"-"])}},{prop:"status",label:"状态",render:function(e,t){return e("div",[0===t.status&&e("el-tag",["草稿"]),1===t.status&&e("el-tag",{attrs:{type:"warning"}},["审核中"]),2===t.status&&e("el-tag",{attrs:{type:"success"}},["已发布"]),-1===t.status&&e("el-tag",{attrs:{type:"danger"}},["已驳回"])])}},{label:"操作",headerAlign:"center",prop:"ffff",width:300,fixed:"right",align:"center",render:function(t,n){return t("div",[t("el-button",{on:{click:function(){return e.addOrEdit("view",n)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["查看"]),t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-tianxie",type:"text"},on:{click:function(){return e.addOrEdit("edit",n)}}},["编辑"]),!1,t("el-button",{attrs:{size:e.size,icon:" kr-shanchu krIconfont",type:"text"},on:{click:function(){return e.del(n)}},style:"color:red"},["删除"])])}}],showDetail:!1,menuOptions:[],menuIdOptions:[],defaultProps:{children:"children",label:"name"}}},computed:Object(i["a"])(Object(i["a"])({},Object(d["c"])({size:function(e){return e.config.defaultSize}})),{},{getList:function(){return o["a"].list}}),watch:{},created:function(){this.getMenuOptiones(),this.getMenuTreeForAudit()},mounted:function(){},methods:{auditRefuse:function(){var e=this;if(!this.auditMessage)return this.$message({type:"error",message:"请填写审核意见"}),!1;this.$confirm("是否驳回审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.auditRow.id,t.next=3,o["a"].publish({articleId:n,status:-1,auditMessage:e.auditMessage});case 3:if(r=t.sent,a=r.data,0==a.code){t.next=7;break}return t.abrupt("return",e.$message.error(a.msg));case 7:e.$message({type:"success",message:"驳回成功!"}),e.doSearch(),e.dialogVisible=!1;case 10:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消驳回"})}))},getAuditRow:function(e){this.auditRow=e,this.auditMessage="",this.dialogVisible=!0},getMenuTreeForAudit:function(){var e=this;o["a"].getMenuTreeForAudit().then((function(t){e.menuIdOptions=t.data.data,e.menuIdOptions.unshift({nodeIds:"000",name:"全部"})}))},getValue:function(e){this.searchForm.menuId=e?e.nodeIds:"000"},resetParams:function(){this.searchForm.title="",this.searchForm.menuId="000",this.doSearch()},doSearch:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.searchForm.articleStatus=[-1],e.$refs.table.insidePage=1,e.$refs.table.init();case 3:case"end":return t.stop()}}),t)})))()},audit:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e instanceof Array||(e=[e]),0!=e.length){n.next=3;break}return n.abrupt("return",t.$message.error("请选择需要审核的项!"));case 3:t.$confirm("是否通过审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.map((function(e){return e.id})),n.next=3,o["a"].publish({articleId:r,status:2});case 3:if(a=n.sent,s=a.data,0==s.code){n.next=7;break}return n.abrupt("return",t.$message.error(s.msg));case 7:t.$message({type:"success",message:"审核成功!"}),t.doSearch();case 9:case"end":return n.stop()}}),n)})))).catch((function(){t.$message({type:"info",message:"已取消审核"})}));case 4:case"end":return n.stop()}}),n)})))()},addOrEdit:function(e,t){this.$refs.form.init(e,t,t.menuId,!0)},handleSelectionChange:function(e){this.selectedRows=e},del:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e instanceof Array||(e=[e]),0!=e.length){n.next=3;break}return n.abrupt("return",t.$message.error("请选择需要删除的项!"));case 3:t.$confirm("此操作将永久删除所选, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.map((function(e){return e.id})),n.next=3,o["a"].del({articleId:r});case 3:if(a=n.sent,s=a.data,0==s.code){n.next=7;break}return n.abrupt("return",t.$message.error(s.msg));case 7:t.$message({type:"success",message:"删除成功!"}),t.doSearch();case 9:case"end":return n.stop()}}),n)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 4:case"end":return n.stop()}}),n)})))()},getDictList:function(e){return u["a"].getDictList(e)},getMenuOptiones:function(){var e=this;o["a"].getMenuList().then((function(t){e.menuOptions=t.data.data}))},cancelNotification:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.status=0,n.next=3,o["a"].save({id:e.id});case 3:r=n.sent,a=r.data,0==a.code&&(t.$message.success("发布成功！"),t.doSearch()),t.$message.success("撤销成功！"),t.doSearch();case 8:case"end":return n.stop()}}),n)})))()},publicNotification:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.status=1,n.next=3,o["a"].publish({articleId:e.id,status:2});case 3:r=n.sent,a=r.data,0==a.code&&(t.$message.success("发布成功！"),t.doSearch());case 6:case"end":return n.stop()}}),n)})))()}}},m=l,f=(n("90c0"),n("cfac"),n("2877")),h=Object(f["a"])(m,r,a,!1,null,"4b61670e",null);t["default"]=h.exports},"472a":function(e,t,n){},"90c0":function(e,t,n){"use strict";n("00ca")},cfac:function(e,t,n){"use strict";n("472a")}}]);