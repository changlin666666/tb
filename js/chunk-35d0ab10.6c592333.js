(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35d0ab10"],{"0856":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"data-export"},[e._m(0),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tableBox",attrs:{"element-loading-text":"数据导出中..."}},[n("el-tabs",{attrs:{type:"card"},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[n("el-tab-pane",{attrs:{label:"导出excel",name:"Excel"}},[n("kr-table",{attrs:{columns:e.computedColumns,rows:e.computedTableData,total:e.excelTotal,page:e.previewPage,pageSizes:[50,100,200,400],pageSize:e.previewSize,selection:!1},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}},[n("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[n("el-button",{attrs:{type:"primary"},on:{click:e.exportExcelFile}},[e._v(" 导出 ")]),n("el-button",{attrs:{type:"primary",plain:""},on:{click:e.exportCustomExcelFile}},[e._v(" 导出（自定义样式） ")]),n("el-tabs",{staticStyle:{"margin-top":"8px"},attrs:{size:"small",type:"card"},on:{"tab-click":e.sheetChange},model:{value:e.activeSheet,callback:function(t){e.activeSheet=t},expression:"activeSheet"}},e._l(e.sheetsData,(function(e,t){return n("el-tab-pane",{key:t,attrs:{label:e.sheetName,name:t+""}})})),1)],1)])],1),n("el-tab-pane",{attrs:{label:"导出csv",name:"csv"}},[n("kr-table",{attrs:{columns:e.computedColumns,rows:e.computedTableData,total:e.excelTotal,page:e.previewPage,pageSizes:[50,100,200,400],pageSize:e.previewSize,selection:!1},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}},[n("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[n("el-button",{attrs:{type:"primary"},on:{click:e.exportCsvFile}},[e._v(" 导出csv ")])],1)])],1)],1)],1)])},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",{staticClass:"title"},[n("span",{staticClass:"border-left"}),e._v("数据导出示例")])}],i=(n("d81d"),n("fb6a"),n("a630"),n("3ca3"),n("ac1f"),n("1276"),n("99af"),n("21a6")),r=n.n(i),s=n("e8ae"),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export",n=new s.Workbook,a=n.addWorksheet("test");e&&e.length&&e[0].map((function(t,n){null!==t&&void 0!==t||(e[0][n]="")})),a.addRows(e),n.csv.writeBuffer().then((function(e){e="\ufeff"+e;var n=new Blob([e],{type:"text/plain,charset=utf-8"});r.a.saveAs(n,"".concat(t,".csv"))}))},c=(n("d3b7"),n("cb29"),n("e8ae")),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"数据",n=new c.Workbook;"[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),e.map((function(e,t){var a=e.columnsData,o=void 0===a?[]:a,i=e.rowsData,r=void 0===i?[]:i,s=e.sheetName,l=e.renderOptions;s=s||(t?"sheet"+t:"sheet");var c=n.addWorksheet(s);c.columns=o,c.addRows(r),l&&d(c,l)}));n.xlsx.writeBuffer().then((function(e){var n=new Blob([e],{type:"application/vnd.ms-excel;charset=utf-8"});r.a.saveAs(n,"".concat(t,".xlsx"))}))};function d(e,t){var n=t.columnsOptions,a=t.rowsOptions,o=t.cellOptions;n&&n.length&&n.map((function(t){var n=t.columnIndex,a=t.font,o=t.alignment,i=t.border,r=t.fill;a&&(e.getColumn(n).font=a),o&&(e.getColumn(n).alignment=o),i&&(e.getColumn(n).border=i),r&&(e.getColumn(n).fill=r)})),a&&a.length&&a.map((function(t){var n=t.rowIndex,a=t.font,o=t.alignment,i=t.border,r=t.fill;a&&(e.getRow(n).font=a),o&&(e.getRow(n).alignment=o),i&&(e.getRow(n).border=i),r&&(e.getRow(n).fill=r)})),o&&o.length&&o.map((function(t){var n=t.cellIndex,a=t.font,o=t.alignment,i=t.border,r=t.fill;a&&(e.getCell(n).font=a),o&&(e.getCell(n).alignment=o),i&&(e.getCell(n).border=i),r&&(e.getCell(n).fill=r)}))}var f={name:"",components:{},mixins:[],props:{},data:function(){return{loading:!1,activeTabName:"Excel",sheetsData:[],activeSheet:"0",previewPageSize:{0:{page:1,size:50}}}},computed:{previewPage:function(){var e=this.activeSheet,t=this.previewPageSize;return t[e].page},previewSize:function(){var e=this.activeSheet,t=this.previewPageSize;return t[e].size},excelTotal:function(){var e=this.activeSheet,t=this.sheetsData;return t[e].rowsData.length||0},computedColumns:function(){var e=this.activeSheet,t=this.sheetsData;return t[e].headers.map((function(e){return{label:e,prop:e}}))},computedTableData:function(){var e=this.activeSheet,t=this.sheetsData,n=this.previewPageSize,a=n[e],o=a.page,i=a.size;return t[e].rowsData.slice((o-1)*i,o*i)}},watch:{},filter:{},created:function(){this.initExcelData()},mounted:function(){},methods:{initExcelData:function(){var e=Math.round(5*Math.random()+2);this.sheetsData=Array.from({length:e},(function(e,t){var n="sheet"+(t+1),a=Math.round(10*Math.random()+1),o="ABCDEFGHIJKLMNOPQRST".substr(0,a).split(""),i=Array.from({length:Math.round(1e3*Math.random()+50)},(function(e,t){var n={};return o.map((function(e,t){n[e]=e+(Math.round(1e3*Math.random())+t)})),n}));return{sheetName:n,headers:o,rowsData:i}}))},sheetChange:function(e){this.previewPageSize[e.index]||(this.previewPageSize[e.index]={page:1,size:50})},exportExcelFile:function(){var e=this.sheetsData.map((function(e){var t=e.sheetName,n=e.rowsData,a=e.headers,o=a.map((function(e){return{header:e,key:e,width:10}}));return{sheetName:t,rowsData:n,columnsData:o}}));u(e)},exportCustomExcelFile:function(){var e=this.sheetsData.map((function(e){var t=e.sheetName,n=e.rowsData,a=e.headers,o=a.map((function(e){return{header:e,key:e,width:10}}));return{sheetName:t,rowsData:n,columnsData:o,renderOptions:{columnsOptions:[{columnIndex:2,font:{name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0}}],rowsOptions:[{rowIndex:3,font:{name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0}}],cellOptions:[{cellIndex:"A10",font:{name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0}},{cellIndex:"A12",font:{name:"Comic Sans MS",color:{argb:"FFFF0000"},family:4,size:16,underline:"double",bold:!0}}]}}}));u(e)},handleSizeChange:function(e){this.previewPageSize[this.activeSheet].size=e,this.previewPageSize[this.activeSheet].page=1},handleCurrentChange:function(e){this.previewPageSize[this.activeSheet].page=e},exportCsvFile:function(){var e=this.sheetsData[this.activeSheet],t=e.rowsData,n=e.sheetName,a=e.headers,o=[a].concat(t.map((function(e){var t=a.map((function(t){return e[t]}));return t})));l(o,n)}}},p=f,h=(n("a39f"),n("2877")),m=Object(h["a"])(p,a,o,!1,null,"1859fff4",null);t["default"]=m.exports},"21a6":function(e,t,n){(function(n){var a,o,i;(function(n,r){o=[],a=r,i="function"===typeof a?a.apply(t,o):a,void 0===i||(e.exports=i)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function a(e,t,n){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){l(a.response,t,n)},a.onerror=function(){console.error("could not download file")},a.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,n){var s=r.URL||r.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):o(l.href)?a(e,t,n):i(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,r){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,r),n);else if(o(e))a(e,n,r);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){i(s)}))}}:function(e,t,n,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return a(e,t,n);var i="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&l||s)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},u.readAsDataURL(e)}else{var d=r.URL||r.webkitURL,f=d.createObjectURL(e);o?o.location=f:location.href=f,o=null,setTimeout((function(){d.revokeObjectURL(f)}),4e4)}});r.saveAs=l.saveAs=l,e.exports=l}))}).call(this,n("c8ba"))},a39f:function(e,t,n){"use strict";n("da99")},cb29:function(e,t,n){var a=n("23e7"),o=n("81d5"),i=n("44d2");a({target:"Array",proto:!0},{fill:o}),i("fill")},da99:function(e,t,n){}}]);