(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53c5f794"],{"1dae":function(e,t,r){},"1f07":function(e,t,r){"use strict";r("1dae")},"306f":function(e,t,r){},"3d77":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:"文章管理",width:"80%"},on:{"update:visible":function(t){e.visible=t},close:e.close}},["add"==e.method?r("div",{staticClass:"form-page"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"7em",disabled:"view"==e.method},on:{validate:e.formValidated}},[r("el-form-item",{attrs:{label:"文章标题：",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入文章标题",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),r("el-form-item",{attrs:{label:"作者:",prop:"author"}},[r("el-input",{attrs:{placeholder:"请输入文章作者",clearable:""},model:{value:e.form.author,callback:function(t){e.$set(e.form,"author",t)},expression:"form.author"}})],1),r("el-form-item",{attrs:{label:"副标题:",prop:"subtitle"}},[r("el-input",{attrs:{placeholder:"请输入副标题",clearable:""},model:{value:e.form.subtitle,callback:function(t){e.$set(e.form,"subtitle",t)},expression:"form.subtitle"}})],1),r("el-form-item",{attrs:{label:"来源名称:",prop:"sourceName"}},[r("el-input",{attrs:{placeholder:"请输入来源名称",clearable:""},model:{value:e.form.sourceName,callback:function(t){e.$set(e.form,"sourceName",t)},expression:"form.sourceName"}})],1),r("el-form-item",{attrs:{label:"密级:",prop:"secretGrade"}},[r("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择",size:e.size},model:{value:e.form.secretGrade,callback:function(t){e.$set(e.form,"secretGrade",t)},expression:"form.secretGrade"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"部门:"}},[r("el-col",{staticClass:"margin-t-20",attrs:{span:8}},[r("el-cascader",{staticStyle:{width:"250px"},attrs:{options:e.options2,props:e.expandTrigger},model:{value:e.inputs1,callback:function(t){e.inputs1=t},expression:"inputs1"}})],1)],1),r("el-form-item",{attrs:{label:"是否置顶:",prop:"topping"}},[r("el-col",{attrs:{span:12}},[r("el-radio",{attrs:{label:"1"},model:{value:e.form.topping,callback:function(t){e.$set(e.form,"topping",t)},expression:"form.topping"}},[e._v("是")]),r("el-radio",{attrs:{label:"0"},model:{value:e.form.topping,callback:function(t){e.$set(e.form,"topping",t)},expression:"form.topping"}},[e._v("否")])],1)],1),r("el-form-item",{attrs:{label:"标题图:"}},[r("kr-upload",{attrs:{"http-request":e.httpRequest,action:e.$BASE_URL+"/source/upload","auto-upload":!0,accept:".png,.jpg,.gif","list-type":"picture-card","on-remove":e.handleImgRemove,imgEditEnable:!0,imgCutOption:e.imgCutOption,"before-upload":e.beforeupload}})],1),r("el-form-item",{attrs:{label:"正文:",prop:"content"}},[e.visible?r("Editor",{ref:"editor",attrs:{readonly:"view"==e.method,height:300},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}):e._e()],1),r("el-form-item",{staticStyle:{"text-align":"center"}})],1)],1):e._e(),"edit"==e.method?r("div",{staticClass:"form-page"},[r("el-form",{ref:"form1",attrs:{model:e.form1,rules:e.rules,"label-width":"7em",disabled:"view"==e.method},on:{validate:e.formValidated}},[r("el-form-item",{attrs:{label:"文章标题：",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入文章标题",clearable:""},model:{value:e.form1.title,callback:function(t){e.$set(e.form1,"title",t)},expression:"form1.title"}})],1),r("el-form-item",{attrs:{label:"作者:",prop:"author"}},[r("el-input",{attrs:{placeholder:"请输入文章作者",clearable:""},model:{value:e.form1.author,callback:function(t){e.$set(e.form1,"author",t)},expression:"form1.author"}})],1),r("el-form-item",{attrs:{label:"副标题:",prop:"subtitle"}},[r("el-input",{attrs:{placeholder:"请输入副标题",clearable:""},model:{value:e.form1.subtitle,callback:function(t){e.$set(e.form1,"subtitle",t)},expression:"form1.subtitle"}})],1),null!=e.form1.sourceName?r("el-form-item",{attrs:{label:"来源名称:",prop:"sourceName"}},[r("el-input",{attrs:{placeholder:"请输入来源名称",clearable:""},model:{value:e.form1.sourceName,callback:function(t){e.$set(e.form1,"sourceName",t)},expression:"form1.sourceName"}})],1):e._e(),r("el-form-item",{attrs:{label:"密级:",prop:"secretGrade"}},[r("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择",size:e.size},model:{value:e.form1.secretGrade,callback:function(t){e.$set(e.form1,"secretGrade",t)},expression:"form1.secretGrade"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"部门:"}},[r("el-col",{staticClass:"margin-t-20",attrs:{span:8}},[r("el-cascader",{staticStyle:{width:"250px"},attrs:{options:e.options2,props:e.expandTrigger},model:{value:e.inputs2,callback:function(t){e.inputs2=t},expression:"inputs2"}})],1)],1),r("el-form-item",{attrs:{label:"是否置顶:",prop:"topping"}},[r("el-col",{attrs:{span:12}},[r("el-radio",{attrs:{label:"1"},model:{value:e.form1.topping,callback:function(t){e.$set(e.form1,"topping",t)},expression:"form1.topping"}},[e._v("是")]),r("el-radio",{attrs:{label:"0"},model:{value:e.form1.topping,callback:function(t){e.$set(e.form1,"topping",t)},expression:"form1.topping"}},[e._v("否")])],1)],1),r("el-form-item",{attrs:{label:"标题图:"}},[r("kr-upload",{attrs:{action:e.$BASE_URL+"/source/upload","auto-upload":!0,accept:".png,.jpg,.gif","list-type":"picture-card","on-remove":e.handleImgRemove,imgEditEnable:!0,imgCutOption:e.imgCutOption,"file-list":e.fileList1,"before-upload":e.beforeupload}})],1),r("el-form-item",{attrs:{label:"正文:",prop:"content"}},[e.visible?r("Editor",{ref:"editor",attrs:{readonly:"view"==e.method,height:300},model:{value:e.form1.content,callback:function(t){e.$set(e.form1,"content",t)},expression:"form1.content"}}):e._e()],1),r("el-form-item",{staticStyle:{"text-align":"center"}})],1)],1):e._e(),"view"==e.method?r("div",{staticClass:"form-page"},[r("el-form",{ref:"form1",attrs:{model:e.form1,rules:e.rules,"label-width":"7em",disabled:"view"==e.method},on:{validate:e.formValidated}},[r("el-form-item",{attrs:{label:"文章标题：",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入文章标题",clearable:""},model:{value:e.form1.title,callback:function(t){e.$set(e.form1,"title",t)},expression:"form1.title"}})],1),r("el-form-item",{attrs:{label:"作者:",prop:"author"}},[r("el-input",{attrs:{placeholder:"请输入文章作者",clearable:""},model:{value:e.form1.author,callback:function(t){e.$set(e.form1,"author",t)},expression:"form1.author"}})],1),r("el-form-item",{attrs:{label:"副标题:",prop:"subtitle"}},[r("el-input",{attrs:{placeholder:"请输入副标题",clearable:""},model:{value:e.form1.subtitle,callback:function(t){e.$set(e.form1,"subtitle",t)},expression:"form1.subtitle"}})],1),null!=e.form1.sourceName?r("el-form-item",{attrs:{label:"来源名称:",prop:"sourceName"}},[r("el-input",{attrs:{placeholder:"请输入来源名称",clearable:""},model:{value:e.form1.sourceName,callback:function(t){e.$set(e.form1,"sourceName",t)},expression:"form1.sourceName"}})],1):e._e(),r("el-form-item",{attrs:{label:"密级:",prop:"secretGrade"}},[r("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择",size:e.size},model:{value:e.form1.secretGrade,callback:function(t){e.$set(e.form1,"secretGrade",t)},expression:"form1.secretGrade"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),null!=e.form1.image?r("el-form-item",{attrs:{label:"标题图:",prop:"image"}},[r("img",{staticStyle:{width:"148px",height:"148px"},attrs:{src:e.previewUrl,alt:""}})]):e._e(),r("el-form-item",{attrs:{label:"正文:",prop:"content"}},[e.visible?r("Editor",{ref:"editor",attrs:{readonly:"view"==e.method,height:300},model:{value:e.form1.content,callback:function(t){e.$set(e.form1,"content",t)},expression:"form1.content"}}):e._e()],1),r("el-form-item",{staticStyle:{"text-align":"center"}})],1)],1):e._e(),"view"!=e.method?r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.close}},[e._v("取 消")]),r("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"warning"},on:{click:function(t){return e.validForm(0)}}},[e._v(e._s("add"==e.method?"新增草稿":"保存草稿"))]),r("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:function(t){return e.validForm(1)}}},[e._v("立即发布")])],1):e._e()])},o=[],i=r("1da1"),n=r("5530"),s=(r("96cf"),r("c740"),r("a434"),r("b680"),r("d3b7"),r("25f0"),r("f477")),l=r("9f0d"),c=r("c19a"),u=r("038f"),m=r("85b6"),f=r("5444"),d=r("2f62"),p={components:{userSelect:l["a"],krUpload:m["a"]},props:{},data:function(){return{dictUtils:s["a"],visible:!1,data:null,form:new c["a"],form1:new c["a"],userIds:[],select1:"",organId:"",options:[{value:"核心",label:"核心"},{value:"绝密",label:"绝密"},{value:"机密",label:"机密"},{value:"秘密",label:"秘密"},{value:"公开",label:"公开"}],options1:[{value:1,label:"刊稿"},{value:0,label:"投稿"}],selectes:"",rules:{title:{required:!0,message:"请输入文章标题",trigger:"blur"},type:{required:!0,message:"请选择文章类型",trigger:"blur"},content:{required:!0,message:"请输入文章内容",trigger:"blur"},author:{required:!0,message:"请输入作者",trigger:"blur"},subtitle:{required:!0,message:"请输入副标题",trigger:"blur"},sourceName:{required:!0,message:"请输入来源名称",trigger:"blur"},secretGrade:{required:!0,message:"请输入来源密级",trigger:"blur"},inputs1:{required:!0,message:"请选择部门:",trigger:"blur"}},method:"",imgCutOption:{boxWidth:636,boxHeight:520,originalGraph:!1,rate:"4:3"},fileList1:[{url:""}],fileListimg:[],fileList2:[],inputs1:"",inputs2:"",size:"",fileSysType:"",currentFolderId:"",acceptFormate:"",previewUrl:"",cupload:{name:"",percent:0},options2:[{}],expandTrigger:{label:"name",value:"organId",children:"children"},pid:0,source:"file",duration:""}},computed:Object(n["a"])({},Object(d["c"])({user:function(e){return e.user.user}})),watch:{"form.fullFlag":{handler:function(e){0==e&&(this.form.notifyRecordIds=[])}}},created:function(){},mounted:function(){function e(){var e=new Date,r=e.getFullYear(),a=e.getMonth()+1,o=e.getDate(),i=e.getHours(),n=e.getMinutes(),s=e.getSeconds(),l=r+"-"+t(a)+"-"+t(o)+" "+t(i)+":"+t(n)+":"+t(s);return l}function t(e){return e<10?"0"+e:e}this.form.publishTime=e(this.form.publishTime),this.optiones()},methods:{optiones:function(){var e=this;u["a"].getOaDeptTree().then((function(t){e.options2=t.data.data}))},httpRequest:function(e){setTimeout((function(){e.onProgress({percent:25})}),1e3),setTimeout((function(){e.onProgress({percent:65})}),2e3),setTimeout((function(){e.onProgress({percent:100})}),3e3),setTimeout((function(){e.onSuccess()}),4e3)},handleImgRemove:function(e,t){var r=t.findIndex((function(t){return t.uid===e.uid}));r>=0&&t.splice(r,1)},beforeupload:function(e){var t=this,r="image/jpeg"===e.type||"image/png"==e.type,a=e.size/1024/1024<20;if(r){if(a)return console.log(e),f["d"].uploadFile({file:e,pid:this.pid,source:this.source}).then((function(e){console.log(e,"res"),t.form.image="/source/download?id="+e.data.data.id,t.form1.image="/source/download?id="+e.data.data.id,t.form.articleFiles=e.data.data}));this.$message.error("上传头像图片大小不能超过 20MB")}else this.$message.error("上传图片只能是JPG或PNG格式")},init:function(e,t){var r=this;this.method=e,this.visible=!0,this.userIds=[],this.from1=new c["a"],this.$nextTick(Object(i["a"])(regeneratorRuntime.mark((function a(){var o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("add"==e){a.next=11;break}return a.next=3,u["a"].detail({articleId:t.id});case 3:o=a.sent,r.form1=o.data.data,console.log(o),r.previewUrl="http://130.0.1.1:33400"+r.form1.image,r.fileList1[0].url="http://130.0.1.1:33400"+r.form1.image,console.log(r.form1,"form1"),console.log(r.fil),r.form1.type=String(r.form.type);case 11:case"end":return a.stop()}}),a)}))))},close:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.method="",e.visible=!1;case 2:case"end":return t.stop()}}),t)})))()},converseSize:function(e){var t="";return t=e>=1073741824?(e/1073741824).toFixed(2)+"G":e>=1048576?(e/1024/1024).toFixed(0)+"M":e>=1024?(e/1024).toFixed(0)+"kb":e&&e+"B",t},validForm:function(e){var t=this;if(console.log(this.form.deptId),"add"==this.method){if(1==this.inputs1.length)return void(this.form.deptId=this.inputs1.toString());if(this.inputs1.length>1){var r=this.inputs1.splice(0,1);this.form.deptId=r.toString()}this.$refs.form.validate(function(){var r=Object(i["a"])(regeneratorRuntime.mark((function r(a){var o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log(a,"v"),!a){r.next=14;break}return t.form.status=e,r.next=5,u["a"].save(t.form);case 5:if(o=r.sent,i=o.data,0==i.code){r.next=9;break}return r.abrupt("return",t.$message.error(i.msg));case 9:t.$message.success(i.msg),t.$parent.$refs.table.init(),t.close(),r.next=15;break;case 14:return r.abrupt("return",!1);case 15:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}else{if(1==this.inputs2.length)return void(this.form1.deptId=this.inputs2.toString());if(this.inputs2.length>1){var a=this.inputs2.splice(0,1);this.form1.deptId=a.toString()}this.$refs.form1.validate(function(){var r=Object(i["a"])(regeneratorRuntime.mark((function r(a){var o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log(a,"v"),!a){r.next=14;break}return t.form1.status=e,r.next=5,u["a"].save(t.form1);case 5:if(o=r.sent,i=o.data,0==i.code){r.next=9;break}return r.abrupt("return",t.$message.error(i.msg));case 9:t.$message.success(i.msg),t.$parent.$refs.table.init(),t.close(),r.next=15;break;case 14:return r.abrupt("return",!1);case 15:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}},formValidated:function(e,t,r){console.log(e,t,r)},getDictList:function(e){return s["a"].getDictList(e)}}},b=p,h=(r("521c"),r("1f07"),r("2877")),g=Object(h["a"])(b,a,o,!1,null,"0fbae289",null);t["default"]=g.exports},"521c":function(e,t,r){"use strict";r("306f")},"92a4":function(e,t,r){"use strict";r("b16c")},b16c:function(e,t,r){},c93a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"notification"},[r("div",{staticClass:"content-header"},[r("el-form",{ref:"elForm",staticClass:"filter-form",attrs:{inline:!0,model:e.searchForm}},[r("el-form-item",[r("el-input",{attrs:{placeholder:"文章名称",clearable:""},model:{value:e.searchForm.title,callback:function(t){e.$set(e.searchForm,"title",t)},expression:"searchForm.title"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.doSearch}},[e._v("查询")]),r("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:e.resetParams}},[e._v("重置")])],1)],1)],1),r("div",{staticClass:"table"},[r("kr-table",{ref:"table",attrs:{columns:e.columns,fetchFunc:e.getList,searchParams:e.searchForm},on:{"selection-change":e.handleSelectionChange}},[r("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.addOrEdit("add")}}},[e._v("新增文章")]),r("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",disabled:0==e.selectedRows.length},on:{click:function(t){return e.del(e.selectedRows)}}},[e._v("批量删除"+e._s(e.selectedRows.length?"("+e.selectedRows.length+")":""))])],1)])],1),r("formDialog",{ref:"form"})],1)},o=[],i=r("1da1"),n=r("5530"),s=(r("d81d"),r("96cf"),r("3d77")),l=r("038f"),c=r("f477"),u=r("2f62"),m={name:"sys-notification",components:{formDialog:s["default"]},props:{},data:function(){this.$createElement;var e=this;return{notiType:[],searchForm:{articleStatus:[],ascs:"",current:1,deptId:"",descs:"create_time",menuId:"000/010",orgId:"",size:20},selectedRows:[],total:100,rows:[],columns:[{prop:"title",label:"文章标题",render:function(e,t){return e("div",{style:"color:var(--defaultTheme)"},[t.title])}},{prop:"author",sortable:!0,label:"作者"},{prop:"secretGrade",label:"密级",sortable:!0},{prop:"publishTime",label:"发布时间",sortable:!0,width:"300"},{prop:"status",label:"状态",render:function(e,t){return e("div",[0===t.status&&e("el-tag",["草稿"]),1===t.status&&e("el-tag",{attrs:{type:"warning"}},["审核中"]),2===t.status&&e("el-tag",{attrs:{type:"success"}},["已发布"]),-1===t.status&&e("el-tag",{attrs:{type:"danger"}},["已驳回"])])}},{label:"操作",headerAlign:"center",prop:"ffff",width:120,fixed:"right",align:"right",render:function(t,r){return t("div",[t("el-button",{on:{click:function(){return e.addOrEdit("view",r)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["查看"]),0===r.status&&t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-tianxie",type:"text"},on:{click:function(){return e.addOrEdit("edit",r)}}},["编辑"]),0===r.status&&t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-icon_fabu",type:"text"},on:{click:function(){return e.publicNotification(r)}}},["发布"]),t("el-button",{attrs:{size:e.size,icon:" kr-shanchu krIconfont",type:"text"},on:{click:function(){return e.del(r)}},style:"color:red"},["删除"])])}}],showDetail:!1}},computed:Object(n["a"])(Object(n["a"])({},Object(u["c"])({size:function(e){return e.config.defaultSize}})),{},{getList:function(){return l["a"].list}}),watch:{},created:function(){},mounted:function(){},methods:{resetParams:function(){this.searchForm={articleStatus:[],ascs:"",current:1,deptId:"",descs:"create_time",menuId:"000/010",orgId:"",size:20},this.doSearch()},doSearch:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.table.insidePage=1,e.$refs.table.init();case 2:case"end":return t.stop()}}),t)})))()},addOrEdit:function(e,t){this.$refs.form.init(e,t)},handleSelectionChange:function(e){this.selectedRows=e},del:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e instanceof Array||(e=[e]),0!=e.length){r.next=3;break}return r.abrupt("return",t.$message.error("请选择需要删除的项!"));case 3:t.$confirm("此操作将永久删除所选, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function r(){var a,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.map((function(e){return e.id})),r.next=3,l["a"].del({articleId:a});case 3:if(o=r.sent,i=o.data,0==i.code){r.next=7;break}return r.abrupt("return",t.$message.error(i.msg));case 7:t.$message({type:"success",message:"删除成功!"}),t.doSearch();case 9:case"end":return r.stop()}}),r)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 4:case"end":return r.stop()}}),r)})))()},getDictList:function(e){return c["a"].getDictList(e)},cancelNotification:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.status=0,r.next=3,l["a"].save({id:e.id});case 3:a=r.sent,o=a.data,0==o.code&&(t.$message.success("发布成功！"),t.doSearch()),t.$message.success("撤销成功！"),t.doSearch();case 8:case"end":return r.stop()}}),r)})))()},publicNotification:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.status=1,r.next=3,l["a"].publish({articleId:e.id,status:2});case 3:a=r.sent,o=a.data,0==o.code&&(t.$message.success("发布成功！"),t.doSearch());case 6:case"end":return r.stop()}}),r)})))()}}},f=m,d=(r("92a4"),r("2877")),p=Object(d["a"])(f,a,o,!1,null,"1fa1508d",null);t["default"]=p.exports}}]);