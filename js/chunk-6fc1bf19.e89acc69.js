(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6fc1bf19"],{"6f63":function(e,t,r){"use strict";r("d138")},b799:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:e.title,width:e.width,fullscreen:""},on:{"update:visible":function(t){e.visible=t},close:e.close}},[r("el-form",{ref:"form",attrs:{"label-width":"120px",model:e.form,size:"medium",rules:e.rules,disabled:"view"==e.method},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit.apply(null,arguments)}}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"收件人",prop:"notifyRecordIds"}},[r("el-radio-group",{model:{value:e.form.fullFlag,callback:function(t){e.$set(e.form,"fullFlag",t)},expression:"form.fullFlag"}},[r("el-radio-button",{attrs:{label:1}},[e._v("全员")]),r("el-radio-button",{attrs:{label:0}},[e._v("指定人员")])],1),0==e.form.fullFlag?r("userSelect",{attrs:{disabled:"view"==e.method},model:{value:e.form.notifyRecordIds,callback:function(t){e.$set(e.form,"notifyRecordIds",t)},expression:"form.notifyRecordIds"}}):e._e()],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"标题",prop:"title"}},[r("el-input",{attrs:{disabled:"view"==e.method,placeholder:"请输入键值"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{prop:"content"}},[e.visible?r("Editor",{ref:"editor",attrs:{readonly:"view"==e.method,height:500},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}):e._e()],1),"view"==e.method&&2==e.active?r("el-form-item",{attrs:{label:"阅读列表"}},[r("el-table",{attrs:{data:e.form.notifyRecordList}},[r("el-table-column",{attrs:{label:"接收人",prop:"userName"}}),r("el-table-column",{attrs:{label:"阅读状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:t.row.readFlag?"success":"primary"}},[e._v(e._s(t.row.readFlag?"已读":"未读"))])]}}],null,!1,965423750)}),r("el-table-column",{attrs:{label:"阅读时间",prop:"readDate"}})],1)],1):e._e()],1)],1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.close}},[e._v("取 消")]),"view"!=e.method?r("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.validForm(0)}}},[e._v(e._s("add"==e.method?"新增草稿":"保存草稿"))]):e._e(),"view"!=e.method?r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.validForm(1)}}},[e._v("立即发布")]):e._e()],1)],1)},o=[],a=r("1da1"),l=r("5530"),i=(r("96cf"),r("a9e3"),r("99af"),r("b0c0"),r("9f0d")),s=r("96e6"),c=r("2f62"),u={components:{userSelect:i["a"]},props:{width:{type:String,default:"80%"},active:{type:Number,default:1}},data:function(){return{visible:!1,method:"",form:{title:"",content:"",notifyRecordIds:[],fullFlag:1},rules:{title:[{required:!0,message:"标题不能为空"}]},id:"",title:""}},computed:Object(l["a"])({},Object(c["c"])({user:function(e){return e.user.user}})),methods:{init:function(e,t,r){var n=this;this.method=e,this.form={title:"",notifyRecordIds:[],content:"",fullFlag:1},this.title="add"===e?"写信":"view"==e?"查看":"reply"==e?"回复":"编辑",this.id=t,this.visible=!0,this.$nextTick(Object(a["a"])(regeneratorRuntime.mark((function o(){var a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n.$refs.editor.initTinymce(),n.$refs.form.resetFields(),"view"!=e&&"edit"!=e){o.next=10;break}return o.next=5,s["a"].mailDetail({id:t});case 5:a=o.sent,n.form=a.data.data,n.form.type=String(n.form.type),o.next=11;break;case 10:"reply"==e&&(n.form.fullFlag=0,n.form.notifyRecordIds=[r.createUserId],n.form.title="回复："+r.createUserName,n.form.content="<p>------------------&nbsp;原始邮件&nbsp;------------------</p>\n                              <p>发件人:".concat(r.createUserName,"</p>\n                              <p>发送时间:").concat(r.publishTime,"</p>\n                              <p>收件人:").concat(n.user.name,"</p>\n                              <p>主题:").concat(r.title,"</p>"));case 11:case"end":return o.stop()}}),o)}))))},close:function(){this.visible=!1,this.$refs.editor.destroyTinymce()},validForm:function(e){var t=this;this.$refs.form.validate(function(){var r=Object(a["a"])(regeneratorRuntime.mark((function r(n){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!n){r.next=14;break}return t.form.status=e,r.next=4,s["a"].mailSave(t.form);case 4:if(o=r.sent,a=o.data,0==a.code){r.next=8;break}return r.abrupt("return",t.$message.error(a.msg));case 8:t.$message.success(a.msg),t.$parent.$refs.table.init(),t.$parent.init(),t.close(),r.next=15;break;case 14:return r.abrupt("return",!1);case 15:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}}},f=u,d=(r("6f63"),r("2877")),m=Object(d["a"])(f,n,o,!1,null,"4321ddc3",null);t["default"]=m.exports},d138:function(e,t,r){}}]);