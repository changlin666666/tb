(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a9e78258"],{"0d70":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.visible,title:"发帖",width:"60%"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[a("div",{staticClass:"form-page"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"7em",disabled:"view"==e.method},on:{validate:e.formValidated}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"帖子标题：",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入帖子标题",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"作者:",prop:"authorName"}},[a("el-input",{attrs:{placeholder:"请输入帖子作者",disabled:"",clearable:""},model:{value:e.form.authorName,callback:function(t){e.$set(e.form,"authorName",t)},expression:"form.authorName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"部门:",prop:"deptId"}},[a("kr-tree-select",{staticStyle:{width:"100%"},attrs:{data:e.options2,disabled:"",props:e.defaultProps,nodeKey:"organId"},on:{getValue:e.getValue},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"模块:",prop:"moduleId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:e.size},model:{value:e.form.moduleId,callback:function(t){e.$set(e.form,"moduleId",t)},expression:"form.moduleId"}},e._l(e.moduleIdOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:0,max:1e4},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否精华:",prop:"essence"}},[a("el-col",{attrs:{span:12}},[a("el-radio",{attrs:{label:1},model:{value:e.form.essence,callback:function(t){e.$set(e.form,"essence",t)},expression:"form.essence"}},[e._v("是")]),a("el-radio",{attrs:{label:0},model:{value:e.form.essence,callback:function(t){e.$set(e.form,"essence",t)},expression:"form.essence"}},[e._v("否")])],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否置顶:",prop:"topping"}},[a("el-col",{attrs:{span:12}},[a("el-radio",{attrs:{label:1},model:{value:e.form.topping,callback:function(t){e.$set(e.form,"topping",t)},expression:"form.topping"}},[e._v("是")]),a("el-radio",{attrs:{label:0},model:{value:e.form.topping,callback:function(t){e.$set(e.form,"topping",t)},expression:"form.topping"}},[e._v("否")])],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"发布时间:",prop:"publishTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{align:"right","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择发布时间"},model:{value:e.form.publishTime,callback:function(t){e.$set(e.form,"publishTime",t)},expression:"form.publishTime"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"正文:",prop:"content"}},[e.visible?a("Editor",{ref:"editor",attrs:{readonly:"view"==e.method,height:500},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}):e._e()],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{staticStyle:{"text-align":"center"}})],1)],1)],1),"view"!=e.method?a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:function(t){return e.validForm(1)}}},[e._v("发布 ")])],1):e._e()])},o=[],l=a("1da1"),i=a("5530"),s=(a("96cf"),a("159b"),a("b0c0"),a("f477")),n=a("9f0d"),c=a("d4ec"),u=a("ade3"),d=function e(){Object(c["a"])(this,e),Object(u["a"])(this,"author",""),Object(u["a"])(this,"comments",0),Object(u["a"])(this,"content",""),Object(u["a"])(this,"createTime",null),Object(u["a"])(this,"createUser",null),Object(u["a"])(this,"deptId",""),Object(u["a"])(this,"essence",0),Object(u["a"])(this,"id",null),Object(u["a"])(this,"linkUrl",""),Object(u["a"])(this,"moduleId",""),Object(u["a"])(this,"orgId",""),Object(u["a"])(this,"publishTime",""),Object(u["a"])(this,"sort",100),Object(u["a"])(this,"status",1),Object(u["a"])(this,"subtitle",""),Object(u["a"])(this,"tags",""),Object(u["a"])(this,"title",""),Object(u["a"])(this,"topping",0),Object(u["a"])(this,"updateTime",null),Object(u["a"])(this,"updateUser",null),Object(u["a"])(this,"authorName",""),Object(u["a"])(this,"views",0)},m=a("038f"),f=a("85b6"),p=(a("5444"),a("2f62")),b=(a("4be7"),{components:{userSelect:n["a"],krUpload:f["a"]},props:{},data:function(){return{dictUtils:s["a"],visible:!1,data:null,form:new d,userIds:[],select1:"",organId:"",options:[{value:"核心",label:"核心"},{value:"绝密",label:"绝密"},{value:"机密",label:"机密"},{value:"秘密",label:"秘密"},{value:"公开",label:"公开"}],options1:[{value:1,label:"刊稿"},{value:0,label:"投稿"}],selectes:"",rules:{title:{required:!0,message:"请输入文章标题",trigger:"blur"},moduleId:{required:!0,message:"请选择模块",trigger:"blur"},content:{required:!0,message:"请输入文章内容",trigger:"blur"},author:{required:!0,message:"请输入作者",trigger:"blur"}},method:"",imgCutOption:{boxWidth:636,boxHeight:520,originalGraph:!1,rate:"4:3"},fileList1:[{url:""}],fileListimg:[],fileList2:[],inputs1:"",inputs2:"",size:"",fileSysType:"",currentFolderId:"",acceptFormate:"",previewUrl:"",cupload:{name:"",percent:0},options2:[],expandTrigger:{label:"name",value:"organId",children:"children"},pid:0,source:"file",duration:"",defaultProps:{children:"children",label:"name"},moduleIdOptions:[]}},computed:Object(i["a"])({},Object(p["c"])({user:function(e){return e.user.user}})),watch:{"form.fullFlag":{handler:function(e){0==e&&(this.form.notifyRecordIds=[])}}},created:function(){},mounted:function(){this.optiones()},methods:{getTime:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,r=e.getDate(),o=e.getHours(),l=e.getMinutes(),i=e.getSeconds(),s=t+"-"+this.addZero(a)+"-"+this.addZero(r)+" "+this.addZero(o)+":"+this.addZero(l)+":"+this.addZero(i);return s},addZero:function(e){return e<10?"0"+e:e},optiones:function(){var e=this;m["a"].getOaDeptTree().then((function(t){e.options2=t.data.data})),this.moduleIdOptions=[],m["a"].getForumModulePage({}).then((function(t){t.data.data.records.forEach((function(t){e.moduleIdOptions.push({value:t.id,label:t.name})}))}))},getValue:function(e){this.form.deptId=e?e.organId:""},init:function(e,t){var a=this;this.method=e,this.visible=!0,this.userIds=[],this.form=new d,this.form.author=this.user.id,this.form.authorName=this.user.name,this.form.deptId=this.user.oadept,this.$nextTick(Object(l["a"])(regeneratorRuntime.mark((function r(){var o,l,i,s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if("add"==e){r.next=10;break}return r.next=3,m["a"].queryForumArticleById({id:t.id});case 3:s=r.sent,a.form=s.data.data,a.form.content=s.data.data.articleContent.content,n=JSON.parse(localStorage.getItem("allUser")),a.form.authorName=null===(o=n[null===s||void 0===s||null===(l=s.data)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.author])||void 0===o?void 0:o.name,r.next=11;break;case 10:a.form.publishTime=a.getTime();case 11:case"end":return r.stop()}}),r)}))))},close:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.method="",e.visible=!1;case 2:case"end":return t.stop()}}),t)})))()},validForm:function(e){var t=this;console.log(this.form),this.$refs.form.validate(function(){var a=Object(l["a"])(regeneratorRuntime.mark((function a(r){var o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r){a.next=13;break}return t.form.status=e,a.next=4,m["a"].saveForumArticle(t.form);case 4:if(o=a.sent,l=o.data,0==l.code){a.next=8;break}return a.abrupt("return",t.$message.error(l.msg));case 8:t.$message.success(l.msg),t.$parent.$refs.table.init(),t.close(),a.next=14;break;case 13:return a.abrupt("return",!1);case 14:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},formValidated:function(e,t,a){console.log(e,t,a)},getDictList:function(e){return s["a"].getDictList(e)}}}),h=b,g=(a("70d2"),a("9efa"),a("2877")),v=Object(g["a"])(h,r,o,!1,null,"fb59c8ba",null);t["default"]=v.exports},"6aea":function(e,t,a){},"70d2":function(e,t,a){"use strict";a("ac2f")},"9efa":function(e,t,a){"use strict";a("6aea")},ac2f:function(e,t,a){}}]);