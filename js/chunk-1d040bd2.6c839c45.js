(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d040bd2"],{"06b9":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[t._m(0),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"tableBox",attrs:{"element-loading-text":"数据读取中..."}},[a("kr-table",{attrs:{tableOptions:t.tableOptions,columns:t.computedColumns,rows:t.computedTableData,total:t.computedAllRows.length,page:t.page,pageSizes:[50,100,200,400],pageSize:t.size,selection:!1},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}},[a("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[a("kr-upload",{ref:"uploadRef",staticClass:"uploadCom",attrs:{"on-change":t.httpRequest,action:"#","on-remove":t.removeFile,"auto-upload":!1,accept:".xls,.xlsx,.csv","show-file-list":!1,tooltip:"只能上传 xls | xlsx | csv 文件"}}),a("div",{staticStyle:{"font-size":"12px",color:"#52536b","margin-left":"12px"}},[t._v(" "+t._s(t.fileName)+" ")]),a("el-radio-group",{staticStyle:{"margin-top":"8px","margin-left":"12px"},attrs:{size:"small"},model:{value:t.activeSheet,callback:function(e){t.activeSheet=e},expression:"activeSheet"}},t._l(t.sheetsData,(function(t,e){return a("el-radio-button",{key:e,attrs:{label:t.sheetName}})})),1)],1)])],1)])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"title"},[a("span",{staticClass:"border-left"}),t._v("Excel数据上传")])}],s=(a("c740"),a("d81d"),a("fb6a"),a("caad"),a("2532"),a("b0c0"),a("85b6")),l=a("3835"),r=(a("a630"),a("3ca3"),a("4fad"),a("e8ae")),o=function(t,e){var a=new r.Workbook;a.xlsx.load(t).then((function(){var t=[];a.eachSheet((function(e,a){var i=e.name,n=e.columnCount,s=Array.from({length:n},(function(t,e){return u(e+1)})),r=[];e.eachRow((function(t,e){var a={};t.eachCell((function(t,e){var i;if(6==t.type)i=t.result;else{if(1===t.type)return a.__mergeCells||(a.__mergeCells=[]),void a.__mergeCells.push(e);i=t.value}a[u(e)]=i})),r.push(a)}));var o=e._merges,c={},d=Object.entries(o);d.map((function(t){var e=Object(l["a"])(t,2),a=e[0],i=e[1],n=i.top,s=i.left,r=i.bottom,o=i.right,u=i.tl;c[a]={top:n,left:s,right:o,bottom:r,tl:u}})),t.push({sheetName:i,headers:s,rowDatas:r,merges:c})})),e(t)}))};function u(t){var e="",a=[],i=function t(e){var i=e-1,n=parseInt(i/26),s=i%26;a.push(s),n>0&&t(n)};i(t),a=a.reverse();for(var n=0;n<a.length;n++)e+=String.fromCharCode(64+parseInt(a[n]+1));return e}a("ac1f"),a("5319"),a("d3b7"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a9"),a("72f7");var c=a("7e97"),d=a.n(c),f=function t(e,a,i){var n=new FileReader,s=e.name.replace(/.csv$/,"");n.onload=function(n){var l=n.target.result;if(!i)return l=new Uint8Array(l),d()(l)?t(e,a,"utf-8"):t(e,a,"gb2312");var r=p(l),o=r&&r.length?r[0].map((function(t,e){return u(e+1)})):[];a([{headers:o,rowDatas:r.map((function(t){var e={};return t.map((function(t,a){e[o[a]]=t})),e})),sheetName:s}])},n.onloadstart=function(){},n.onloadend=function(){},n.onerror=function(){},i?n.readAsText(e,i):n.readAsArrayBuffer(e)},h=",";function p(t){var e=[],a=[],i="",n=!1,s=0,l=function(){a.push(i),i=""},r=function(){l(),e.push(a),a=[]},o=function(e){var a=t.charAt(e);if(a===h)l();else if("\r"===a)"\n"===t.charAt(e+1)&&s++,r();else{if("\n"!==a)return!1;r()}return!0};while(s<t.length){var u=t.charAt(s),c=t.charAt(s+1);if(n||i||'"'!==u)if(n){if('"'!==u)i+=u;else if('"'===c)i+=u,s++;else if(n=!1,!o(++s))throw new Error("Wrong CSV format!")}else o(s)||(i+=u);else n=!0;s++}return i&&r(),e}var m={name:"",components:{krUpload:s["a"]},mixins:[],props:{},data:function(){var t=this;return{tableOptions:{height:"100%","span-method":t.mergeCell},activeSheet:null,sheetsData:[],columns:[],page:1,size:50,loading:!1,fileName:""}},computed:{computedColumns:function(){var t=this.activeSheet,e=this.sheetsData,a=e.findIndex((function(e){return e.sheetName===t}));return-1===a?[]:e[a].headers.map((function(t){return{label:t,prop:t,align:"center"}}))},computedAllRows:function(){var t=this.activeSheet,e=this.sheetsData,a=e.findIndex((function(e){return e.sheetName===t}));return-1===a?[]:e[a].rowDatas},computedTableData:function(){var t=this.computedAllRows,e=this.page,a=this.size;return t.slice((e-1)*a,e*a)}},watch:{},filter:{},created:function(){},mounted:function(){},methods:{mergeCell:function(t){var e=t.row,a=(t.column,t.rowIndex),i=t.columnIndex,n=this.activeSheet,s=this.sheetsData,l=this.page,r=this.size,o=s.findIndex((function(t){return t.sheetName===n}));if(-1===o)return[0,0];var c=s[o].merges,d=u(i+1)+((l-1)*r+a+1);if(c[d]){var f=c[d],h=f.top,p=f.bottom,m=f.left,g=f.right;return[p-h+1,g-m+1]}return!c[d]&&e.__mergeCells&&e.__mergeCells.includes(i+1)?[0,0]:void 0},httpRequest:function(t){var e=this;this.loading=!0;var a=new FileReader;this.fileName=t.name,/.csv$/.test(this.fileName)?f(t.raw,this.setTabelData):(a.readAsArrayBuffer(t.raw),a.onload=function(t){o(a.result,e.setTabelData)})},removeFile:function(){this.rows=[],this.columns=[]},setTabelData:function(t){this.activeSheet=t[0].sheetName,this.sheetsData=t,this.loading=!1},handleSizeChange:function(t){this.size=t,this.page=1},handleCurrentChange:function(t){this.page=t}}},g=m,v=(a("7fee"),a("2877")),C=Object(v["a"])(g,i,n,!1,null,"6d8fcfcc",null);e["default"]=C.exports},"4fad":function(t,e,a){var i=a("23e7"),n=a("6f53").entries;i({target:"Object",stat:!0},{entries:function(t){return n(t)}})},6395:function(t,e,a){"use strict";a("c502")},"6f53":function(t,e,a){var i=a("83ab"),n=a("df75"),s=a("fc6a"),l=a("d1e7").f,r=function(t){return function(e){var a,r=s(e),o=n(r),u=o.length,c=0,d=[];while(u>c)a=o[c++],i&&!l.call(r,a)||d.push(t?[a,r[a]]:r[a]);return d}};t.exports={entries:r(!0),values:r(!1)}},"7e97":function(t,e){t.exports=function(t){var e=0;while(e<t.length)if(9==t[e]||10==t[e]||13==t[e]||32<=t[e]&&t[e]<=126)e+=1;else if(194<=t[e]&&t[e]<=223&&128<=t[e+1]&&t[e+1]<=191)e+=2;else if(224==t[e]&&160<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191||(225<=t[e]&&t[e]<=236||238==t[e]||239==t[e])&&128<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191||237==t[e]&&128<=t[e+1]&&t[e+1]<=159&&128<=t[e+2]&&t[e+2]<=191)e+=3;else{if(!(240==t[e]&&144<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191||241<=t[e]&&t[e]<=243&&128<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191||244==t[e]&&128<=t[e+1]&&t[e+1]<=143&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191))return!1;e+=4}return!0}},"7fee":function(t,e,a){"use strict";a("bcc5")},"85b6":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload",style:{"--drag-width":t.dragOption.width||"360px","--drag-height":t.dragOption.height||"220px"}},["picture-card"===t.$attrs["list-type"]?a("el-upload",t._b({ref:"upload",attrs:{"on-change":t.uploadImgsChange,"on-success":t.uploadSuccess,headers:{token:t.$store.state.user.user.token}},scopedSlots:t._u([{key:"file",fn:function(e){var i=e.file;return a("div",{},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:i.url,alt:""}}),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.handlePictureCardPreview(i)}}},[a("i",{staticClass:"el-icon-zoom-in"})]),t.imgEditEnable&&t.isView?a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleEditImg(i)}}},[a("i",{staticClass:"el-icon-edit-outline"})]):t._e(),t.isView?a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemove(i)}}},[a("i",{staticClass:"el-icon-delete"})]):t._e()])])}}],null,!1,863019275)},"el-upload",t.$attrs,!1),[a("i",{staticClass:"el-icon-plus"})]):a("el-upload",t._b({ref:"upload",attrs:{headers:{token:t.$store.state.user.user.token}},on:{"on-success":t.uploadImgsSuccess}},"el-upload",t.$attrs,!1),[t.$attrs.drag?a("div",{staticClass:"drag-tooltip"},[a("i",{staticClass:"el-icon-upload drag-tooltip-icon"}),a("div",{staticClass:"drag-tooltip-text"},[t._v(" 将文件拖到此处，或 "),a("em",[t._v("点击上传")])]),t.tooltip?a("div",{staticClass:"tooltip-text"},[t._v("支持扩展名："+t._s(t.tooltip))]):t._e()]):t._e(),a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),!t.$attrs.drag&&t.tooltip?a("div",{staticClass:"tooltip-text",attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(t.tooltip))]):t._e()],1),a("el-dialog",{attrs:{title:"图片预览",visible:t.dialogVisible,top:"3vh","append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})]),a("el-dialog",{attrs:{title:"图片剪裁",visible:t.ImgCutterData.visible,"append-to-body":!0},on:{"update:visible":function(e){return t.$set(t.ImgCutterData,"visible",e)}}},[t.ImgCutterData.visible?a("img-cutter",t._b({ref:"ImgCutter",attrs:{showChooseBtn:!1,isModal:!1},on:{loaded:t.imgCutterLoaded,cutDown:t.imgCutDown,onClearAll:function(e){t.ImgCutterData.visible=!1},changeAllreadyCut:t.changeAllreadyCut}},"img-cutter",t.imgCutOption,!1)):t._e()],1)],1)},n=[],s=(a("d3b7"),a("3ca3"),a("ddb0"),a("b0c0"),function(){return a.e("ImgCutter").then(a.bind(null,"447d"))}),l={name:"kr-upload",components:{ImgCutter:s},props:{tooltip:String,isView:{type:Boolean,default:!0},uploadType:{type:String,default:"file"},dragOption:{type:Object,default:function(){return{width:"360px",height:"220px"}}},imgCutOption:{type:Object,default:function(){return{boxHeight:400,boxWidth:800,originalGraph:!1,rate:null}}},imgEditEnable:{type:Boolean,default:!1}},data:function(){return{isAlreadyCut:!1,dialogImageUrl:"",dialogVisible:!1,ImgCutterData:{loadImgCutter:!1,visible:!1,file:null},uid:""}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{changeAllreadyCut:function(t){this.isAlreadyCut=t},uploadSuccess:function(t,e,a){this.loading=!1},uploadImgsChange:function(t,e){!0!==this.$attrs.multiple&&(this.$refs.upload._data.uploadFiles=[t]),this.isAlreadyCut||this.uid===t.uid||(this.ImgCutterData.visible=!0,this.ImgCutterData.file=t),this.uid=t.uid},handleRemove:function(t){this.$attrs["on-remove"](t,this.$refs.upload._data.uploadFiles),this.$emit("remove")},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleEditImg:function(t){t.name||(t.name="无名称.png"),this.ImgCutterData.file=t,this.ImgCutterData.visible=!0},imgCutterLoaded:function(){console.log(),this.$refs.ImgCutter.handleOpen(this.ImgCutterData.file)},imgCutDown:function(t){this.ImgCutterData.file.raw=t.file,this.ImgCutterData.file.raw.uid=this.ImgCutterData.file.uid,this.ImgCutterData.file.url=t.dataURL,this.ImgCutterData.file.size=t.file.size,this.ImgCutterData.file.status="ready",this.ImgCutterData.visible=!1,!1!==this.$attrs["auto-upload"]&&this.$refs.upload.submit(),this.$emit("cutDown",this.ImgCutterData.file)}}},r=l,o=(a("6395"),a("2877")),u=Object(o["a"])(r,i,n,!1,null,"b560955c",null);e["a"]=u.exports},bcc5:function(t,e,a){},c502:function(t,e,a){}}]);