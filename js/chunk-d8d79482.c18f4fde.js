(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d8d79482"],{"1f69":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"notification"},[r("div",{staticClass:"content-header"},[r("el-form",{ref:"elForm",staticClass:"filter-form",attrs:{inline:!0,model:e.searchForm}},[r("el-form-item",[r("el-select",{attrs:{placeholder:"所属分类"},model:{value:e.searchForm.classifyId,callback:function(t){e.$set(e.searchForm,"classifyId",t)},expression:"searchForm.classifyId"}},e._l(e.allClassifyTypeListAndAll,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",[r("el-select",{attrs:{placeholder:"试题类型"},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},e._l(e.questionTypeOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",[r("el-input",{attrs:{placeholder:"题目关键字",clearable:""},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.doSearch}},[e._v("查询")]),r("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:e.resetParams}},[e._v("重置")])],1)],1)],1),r("div",{staticClass:"table"},[r("kr-table",{ref:"table",attrs:{columns:e.columns,fetchFunc:e.getList,searchParams:e.searchForm},on:{"selection-change":e.handleSelectionChange}},[r("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.addOrEdit("add")}}},[e._v("新增问题")]),r("el-button",{attrs:{icon:"el-icon-upload",type:"success"},on:{click:e.exportHandle}},[e._v("导入试题")]),r("el-button",{attrs:{icon:"el-icon-download",type:"warning"},on:{click:e.downloadTemplate}},[e._v("下载模板")])],1)])],1),r("formDialog",{ref:"form",attrs:{allClassifyTypeList:e.allClassifyTypeList}}),r("exportDialog",{ref:"export",attrs:{allClassifyTypeList:e.allClassifyTypeList}})],1)},s=[],n=r("1da1"),i=r("5530"),o=(r("96cf"),r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("159b"),r("b0c0"),r("d81d"),r("412b")),l=r("f537"),c=r("0c3f"),u=(r("f477"),r("2f62")),f={name:"sys-notification",components:{formDialog:o["default"],exportDialog:l["default"]},props:{},data:function(){this.$createElement;var e=this;return{headers:{token:""},importData:{},searchForm:{ascs:"",classifyId:null,current:1,descs:"create_time",keyword:"",paperType:0,size:20,type:null,difficultyLevel:null,exclusionIds:[]},selectedRows:[],total:100,rows:[],columns:[{prop:"content",label:"题目内容",render:function(e,t){return e("div",{style:"color:var(--defaultTheme)"},[t.content])}},{prop:"classifyId",label:"所属分类",align:"center",width:200,sortable:!0,render:function(t,r){return t("div",[e.allClassifyTypeMap[r.classifyId]])}},{prop:"type",label:"试题类型",align:"center",width:200,sortable:!0,render:function(e,t){return e("div",[0===t.type&&e("el-tag",{attrs:{effect:"dark"}},["单选题"]),1===t.type&&e("el-tag",{attrs:{effect:"dark",type:"success"}},["多选题"]),2===t.type&&e("el-tag",{attrs:{effect:"dark",color:"rgb(128,7,183)",type:"info"}},["判断题"]),3===t.type&&e("el-tag",{attrs:{effect:"dark",type:"warning"}},["简答题"]),4===t.type&&e("el-tag",{attrs:{effect:"dark",type:"danger"}},["填空题"])])}},{prop:"createTime",label:"创建时间",width:200,align:"center",sortable:!0},{label:"操作",headerAlign:"center",prop:"ffff",width:200,fixed:"right",align:"center",render:function(t,r){return t("div",[t("el-button",{on:{click:function(){return e.addOrEdit("view",r)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["查看"]),t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-tianxie",type:"text"},on:{click:function(){return e.addOrEdit("edit",r)}}},["编辑"]),t("el-button",{attrs:{size:e.size,icon:" kr-shanchu krIconfont",type:"text"},on:{click:function(){return e.del(r)}},style:"color:red"},["删除"])])}}],showDetail:!1,allClassifyTypeMap:{},allClassifyTypeList:[],allClassifyTypeListAndAll:[],questionTypeOptions:[{value:null,label:"全部题型"},{value:0,label:"单选题"},{value:1,label:"多选题"},{value:2,label:"判断题"},{value:3,label:"简答题"},{value:4,label:"填空题"}]}},computed:Object(i["a"])(Object(i["a"])({},Object(u["c"])({size:function(e){return e.config.defaultSize},user:function(e){return e.user.user}})),{},{getList:function(){return c["a"].getQuestionlist}}),watch:{},created:function(){this.getQuestionClassifyType()},mounted:function(){this.headers.token=this.user.token},methods:{exportHandle:function(){this.$refs.export.init()},downloadTemplate:function(){return Object(n["a"])(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].downloadTemplate({paperType:0});case 2:t=e.sent,r=document.createElement("a"),r.href=window.URL.createObjectURL(new Blob([t.data],{type:"application/octet-stream"})),r.target="_blank",a="问卷问题导入模板.xlsx",console.log(a),r.download=decodeURI(a),document.body.appendChild(r),r.click(),document.body.removeChild(r);case 12:case"end":return e.stop()}}),e)})))()},uploadSuccess:function(e){0==e.code?this.$message.success(e.msg):this.$message.error(e.msg),this.doSearch()},getQuestionClassifyType:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].list({ascs:"",classifyType:0,current:1,descs:"",keyword:"",size:9999});case 2:if(s=t.sent,n=s.data,0==n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.msg));case 6:e.allClassifyTypeList=null===n||void 0===n||null===(r=n.data)||void 0===r?void 0:r.records,e.allClassifyTypeListAndAll=JSON.parse(JSON.stringify(e.allClassifyTypeList)),e.allClassifyTypeListAndAll.unshift({id:null,name:"全部分类"}),null===n||void 0===n||null===(a=n.data)||void 0===a||a.records.forEach((function(t){var r=t.id;e.allClassifyTypeMap[r]=t.name}));case 10:case"end":return t.stop()}}),t)})))()},resetParams:function(){this.searchForm.keyword="",this.searchForm.classifyId=null,this.searchForm.type=null,this.doSearch()},doSearch:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.table.init();case 1:case"end":return t.stop()}}),t)})))()},addOrEdit:function(e,t){this.$refs.form.init(e,t)},handleSelectionChange:function(e){this.selectedRows=e},del:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e instanceof Array||(e=[e]),0!=e.length){r.next=3;break}return r.abrupt("return",t.$message.error("请选择需要删除的项!"));case 3:t.$confirm("此操作将永久删除所选, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function r(){var a,s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.map((function(e){return e.id})),r.next=3,c["a"].deleteQuestionById({id:a});case 3:if(s=r.sent,n=s.data,console.log(n),0==n.code){r.next=8;break}return r.abrupt("return",t.$message.error(n.msg));case 8:t.$message({type:"success",message:"删除成功!"}),t.doSearch();case 10:case"end":return r.stop()}}),r)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 4:case"end":return r.stop()}}),r)})))()}}},d=f,p=(r("3b3a"),r("2877")),m=Object(p["a"])(d,a,s,!1,null,"0dc3876a",null);t["default"]=m.exports},"3b3a":function(e,t,r){"use strict";r("c0ad")},"406a":function(e,t,r){"use strict";r("4b0e")},"4b0e":function(e,t,r){},"67b2":function(e,t,r){},aa6f:function(e,t,r){"use strict";r("67b2")},c0ad:function(e,t,r){},f537:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:"导入数据",width:"60%"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[r("div",{staticClass:"form-page"},[r("el-form",{ref:"form",attrs:{model:e.importData,rules:e.rules,"label-width":"7em",disabled:"view"==e.method},on:{validate:e.formValidated}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"所属分类：",prop:"classifyId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属分类",size:e.size},model:{value:e.importData.classifyId,callback:function(t){e.$set(e.importData,"classifyId",t)},expression:"importData.classifyId"}},e._l(e.allClassifyTypeList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"导入数据：",prop:"classifyId"}},[r("el-upload",{staticStyle:{display:"inline-block",margin:"0 10px"},attrs:{action:e.$BASE_URL+"/exam/backend/question/upload","on-success":e.uploadSuccess,headers:e.headers,data:e.importData,"show-file-list":!1}},[e.importData.classifyId?r("el-button",{attrs:{icon:"el-icon-upload",type:"success"}},[e._v("导入数据")]):r("span",[e._v("请选择所属分类")])],1)],1)],1)],1)],1)])},s=[],n=r("1da1"),i=r("5530"),o=(r("96cf"),r("a434"),r("159b"),r("4e82"),r("f477")),l=r("9f0d"),c=r("b04b"),u=r("0c3f"),f=r("85b6"),d=r("2f62"),p=(r("3e8f"),{components:{userSelect:l["a"],krUpload:f["a"]},props:{allClassifyTypeList:{type:Array,default:function(){return[]}}},data:function(){return{dictUtils:o["a"],visible:!1,data:null,subjective:!1,showIsTianKong:!0,headers:{},importData:{paperType:0,classifyId:""},difficultyLevelOptions:[{value:0,label:"简单"},{value:1,label:"一般"},{value:2,label:"较难"},{value:3,label:"很难"}],form:new c["a"],rules:{type:{required:!0,message:"请选择试题类型",trigger:"blur"},classifyId:{required:!0,message:"请选择所属分类",trigger:"blur"},content:{required:!0,message:"请输入题目内容",trigger:"blur"}},method:"",size:""}},computed:Object(i["a"])({},Object(d["c"])({user:function(e){return e.user.user}})),watch:{"form.fullFlag":{handler:function(e){0==e&&(this.form.notifyRecordIds=[])}}},created:function(){},mounted:function(){this.headers.token=this.user.token},methods:{uploadSuccess:function(e){0==e.code?(this.$message.success("导入成功"),this.close(),this.$parent.$refs.table.init()):this.$message.error("导入失败"+e.msg)},init:function(){this.visible=!0,this.importData={paperType:0,classifyId:null}},handleAdd:function(){this.form.answers.push({analysis:"",content:"",correct:0,questionId:null,sort:1})},removeItem:function(e){this.form.answers.splice(e,1)},close:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.method="",e.visible=!1;case 2:case"end":return t.stop()}}),t)})))()},typeChange:function(e){switch(e){case 0:case 1:case 2:this.subjective=!0,this.showIsTianKong=!0;break;case 3:this.subjective=!1,this.showIsTianKong=!0;break;case 4:this.subjective=!0,this.showIsTianKong=!1;break}},validForm:function(){var e=this;if(0===this.form.type||1===this.form.type||2===this.form.type||4===this.form.type){var t=0;if(this.form.answers.forEach((function(e){e.content||(t+=1)})),t>0)return void this.$message({message:"不允许有空的选项内容",type:"warning"})}var r=0;if(this.form.answers.forEach((function(e){e.correct&&e.content&&(r+=1)})),0===this.form.type){if(r<1)return void this.$message({message:"单选题必须有一个答案",type:"warning"});if(r>1)return void this.$message({message:"单选题答案只能有一个",type:"warning"})}if(1===this.form.type&&r<2)this.$message({message:"多选题至少要有两个正确答案！",type:"warning"});else if(2!==this.form.type||1===r){if(3===this.form.type&&(this.form.answers=[]),4===this.form.type){this.form.answers.forEach((function(e){e.analysis="",e.correct=1}));var a=0;if(this.form.answers.forEach((function(e){e.content&&(a+=1)})),a<1)return void this.$message({message:"填空题至少有一个答案",type:"warning"});var s=0;if(this.form.answers.forEach((function(e){e.content.indexOf("\n")>0&&(s+=1)})),s>0)return void this.$message({message:"填空题答案不允许有换行符",type:"warning"})}console.log(this.form),this.form.answers.forEach((function(e,t){e.sort=t+1})),this.$refs.form.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=12;break}return t.next=3,u["a"].saveQuestion(e.form);case 3:if(a=t.sent,s=a.data,0==s.code){t.next=7;break}return t.abrupt("return",e.$message.error(s.msg));case 7:e.$message.success(s.msg),e.$parent.$refs.table.init(),e.close(),t.next=13;break;case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}else this.$message({message:"判断题只能有一个正确项！",type:"warning"})},formValidated:function(e,t,r){console.log(e,t,r)},getDictList:function(e){return o["a"].getDictList(e)}}}),m=p,h=(r("406a"),r("aa6f"),r("2877")),y=Object(h["a"])(m,a,s,!1,null,"3a8aa048",null);t["default"]=y.exports}}]);