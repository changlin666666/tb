(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e6d02f2"],{3521:function(e,t,r){"use strict";var n=r("7bc1");t["a"]={bindMenu:function(e){return n["a"].post("/sys/bind/bindMenu",e)},list:function(e){return n["a"].post("/sys/bind/queryBindMenus",e)},bindRole:function(e){return n["a"].post("/sys/bind/userBindRoles",e)}}},"70e5":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:"权限分配",width:e.width},on:{"update:visible":function(t){e.visible=t},close:function(t){e.visible=!1}}},[r("el-form",{ref:"form",attrs:{size:"medium"}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",[r("kr-tree",{ref:"tree",staticClass:"tree",attrs:{data:e.treeData,props:e.treeProps,"node-key":e.nodeKey,"show-checkbox":"","default-expanded-keys":e.treeExpandData,"default-checked-keys":e.defaultKeys},on:{check:e.getChecked}})],1)],1)],1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),r("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},a=[],s=r("2909"),i=r("1da1"),u=r("b85c"),c=(r("96cf"),r("a9e3"),r("99af"),r("3521")),d=r("eb40"),o=r("0208");function l(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=Object(u["a"])(e);try{for(i.s();!(r=i.n()).done;){var c=r.value;n.push(c[a]),s>=t||c.children&&c.children.length>0&&(s++,l(c.children,t,n,s))}}catch(d){i.e(d)}finally{i.f()}}var b={props:{width:{type:String,default:"30%"},nodeKey:{type:String,default:"id"},level:{type:Number,default:1},type:{type:String,default:"role"}},data:function(){return{visible:!1,id:"",authList:[],defaultKeys:[],treeData:[],treeProps:{children:"children",label:"name",disabled:"disabled"}}},mounted:function(){this.getAuthTree()},computed:{treeExpandData:function(){var e=[];return l(this.treeData,this.level,e,this.nodeKey),e}},methods:{init:function(e){var t=this;this.id=e,this.visible=!0,this.$nextTick(Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a,s,i,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$refs.tree.$refs.tree.setCheckedKeys([]),n={},r.t0=t.type,r.next="role"===r.t0?5:"user"===r.t0?7:"post"===r.t0?9:"admin"===r.t0?11:13;break;case 5:return n.roleId=e,r.abrupt("break",14);case 7:return n.userId=e,r.abrupt("break",14);case 9:return n.postId=e,r.abrupt("break",14);case 11:return n.id=e,r.abrupt("break",14);case 13:return r.abrupt("break",14);case 14:if("admin"!=t.type){r.next=22;break}return r.next=17,d["a"].getMenus({id:e});case 17:a=r.sent,s=a.data,s.data.length>0&&(t.defaultKeys=s.data),r.next=27;break;case 22:return r.next=24,c["a"].list(n);case 24:i=r.sent,u=i.data,u.data.length>0&&(t.defaultKeys=u.data);case 27:case"end":return r.stop()}}),r)}))))},getAuthTree:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].getFilterMenu({flag:1});case 2:r=t.sent,n=r.data,e.treeData=n.data.children;case 5:case"end":return t.stop()}}),t)})))()},getChecked:function(e,t){this.authList=[].concat(Object(s["a"])(t.checkedKeys),Object(s["a"])(t.halfCheckedKeys))},submit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n,a,i,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,r={menuIds:[].concat(Object(s["a"])(e.$refs.tree.getCheckedKeys()),Object(s["a"])(e.$refs.tree.getHalfCheckedKeys())),postId:null,roleId:null,userId:null},t.t0=e.type,t.next="role"===t.t0?5:"post"===t.t0?7:"user"===t.t0?9:11;break;case 5:return r.roleId=e.id,t.abrupt("break",12);case 7:return r.postId=e.id,t.abrupt("break",12);case 9:return r.userId=e.id,t.abrupt("break",12);case 11:return t.abrupt("break",12);case 12:if("admin"!=e.type){t.next=23;break}return t.next=15,d["a"].saveMenus({id:e.id,menuIds:[].concat(Object(s["a"])(e.$refs.tree.getCheckedKeys()),Object(s["a"])(e.$refs.tree.getHalfCheckedKeys()))});case 15:if(n=t.sent,a=n.data,0==a.code){t.next=19;break}return t.abrupt("return",e.$message.error(a.msg));case 19:e.$message.success(a.msg),e.visible=!1,t.next=31;break;case 23:return t.next=25,c["a"].bindMenu(r);case 25:if(i=t.sent,u=i.data,0==u.code){t.next=29;break}return t.abrupt("return",e.$message.error(u.msg));case 29:e.$message.success(u.msg),e.visible=!1;case 31:e.$emit("update"),t.next=37;break;case 34:t.prev=34,t.t1=t["catch"](0),e.$message.error(t.t1);case 37:case"end":return t.stop()}}),t,null,[[0,34]])})))()}}},f=b,p=r("2877"),h=Object(p["a"])(f,n,a,!1,null,null,null);t["default"]=h.exports},eb40:function(e,t,r){"use strict";var n=r("7bc1");t["a"]={save:function(e){return n["a"].post("/sys/roleAdmin/save",e)},detail:function(e){return n["a"].get("/sys/roleAdmin/queryById",e)},getMenus:function(e){return n["a"].get("/sys/roleAdmin/queryBindMenus",e)},list:function(e){return n["a"].post("/sys/roleAdmin/list",e)},del:function(e){return n["a"].get("/sys/roleAdmin/delete",e)},saveMenus:function(e){return n["a"].post("/sys/roleAdmin/bindMenu",e)}}}}]);