(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08200b0e","chunk-162b8d1c"],{1255:function(e,t,r){},1838:function(e,t,r){"use strict";r("b4fa")},"37a0":function(e,t,r){},4568:function(e,t,r){"use strict";r("d4ec"),r("ade3")},"4e78":function(e,t,r){"use strict";r("37a0")},5228:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.visible,title:"发帖",width:"60%"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[r("div",{staticClass:"form-page"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"7em",disabled:"view"==e.method},on:{validate:e.formValidated}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"帖子标题：",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入帖子标题",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"作者:",prop:"authorName"}},[r("el-input",{attrs:{placeholder:"请输入帖子作者",disabled:"",clearable:""},model:{value:e.form.authorName,callback:function(t){e.$set(e.form,"authorName",t)},expression:"form.authorName"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"部门:",prop:"deptId"}},[r("kr-tree-select",{staticStyle:{width:"100%"},attrs:{data:e.options2,disabled:"",props:e.defaultProps,nodeKey:"organId"},on:{getValue:e.getValue},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"模块:",prop:"moduleId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:e.size},model:{value:e.form.moduleId,callback:function(t){e.$set(e.form,"moduleId",t)},expression:"form.moduleId"}},e._l(e.moduleIdOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[r("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:0,max:1e4},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"是否精华:",prop:"essence"}},[r("el-col",{attrs:{span:12}},[r("el-radio",{attrs:{label:1},model:{value:e.form.essence,callback:function(t){e.$set(e.form,"essence",t)},expression:"form.essence"}},[e._v("是")]),r("el-radio",{attrs:{label:0},model:{value:e.form.essence,callback:function(t){e.$set(e.form,"essence",t)},expression:"form.essence"}},[e._v("否")])],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"是否置顶:",prop:"topping"}},[r("el-col",{attrs:{span:12}},[r("el-radio",{attrs:{label:1},model:{value:e.form.topping,callback:function(t){e.$set(e.form,"topping",t)},expression:"form.topping"}},[e._v("是")]),r("el-radio",{attrs:{label:0},model:{value:e.form.topping,callback:function(t){e.$set(e.form,"topping",t)},expression:"form.topping"}},[e._v("否")])],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"发布时间:",prop:"publishTime"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{align:"right","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择发布时间"},model:{value:e.form.publishTime,callback:function(t){e.$set(e.form,"publishTime",t)},expression:"form.publishTime"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"正文:",prop:"content"}},[e.visible?r("Editor",{ref:"editor",attrs:{readonly:"view"==e.method,height:500},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}):e._e()],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{staticStyle:{"text-align":"center"}})],1)],1)],1),"view"!=e.method?r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.close}},[e._v("取 消")]),r("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:function(t){return e.validForm(1)}}},[e._v("发布 ")])],1):e._e()])},a=[],o=r("1da1"),s=r("5530"),i=(r("96cf"),r("4e82"),r("159b"),r("b0c0"),r("f477")),l=r("9f0d"),c=r("d4ec"),u=r("ade3"),d=function e(){Object(c["a"])(this,e),Object(u["a"])(this,"author",""),Object(u["a"])(this,"comments",0),Object(u["a"])(this,"content",""),Object(u["a"])(this,"createTime",null),Object(u["a"])(this,"createUser",null),Object(u["a"])(this,"deptId",""),Object(u["a"])(this,"essence",0),Object(u["a"])(this,"id",null),Object(u["a"])(this,"linkUrl",""),Object(u["a"])(this,"moduleId",""),Object(u["a"])(this,"orgId",""),Object(u["a"])(this,"publishTime",""),Object(u["a"])(this,"sort",100),Object(u["a"])(this,"status",1),Object(u["a"])(this,"subtitle",""),Object(u["a"])(this,"tags",""),Object(u["a"])(this,"title",""),Object(u["a"])(this,"topping",0),Object(u["a"])(this,"updateTime",null),Object(u["a"])(this,"updateUser",null),Object(u["a"])(this,"authorName",""),Object(u["a"])(this,"views",0)},m=r("038f"),p=r("85b6"),f=(r("5444"),r("2f62")),h=(r("4be7"),{components:{userSelect:l["a"],krUpload:p["a"]},props:{},data:function(){return{dictUtils:i["a"],visible:!1,data:null,form:new d,userIds:[],select1:"",organId:"",options:[{value:"核心",label:"核心"},{value:"绝密",label:"绝密"},{value:"机密",label:"机密"},{value:"秘密",label:"秘密"},{value:"公开",label:"公开"}],options1:[{value:1,label:"刊稿"},{value:0,label:"投稿"}],selectes:"",rules:{title:{required:!0,message:"请输入文章标题",trigger:"blur"},moduleId:{required:!0,message:"请选择模块",trigger:"blur"},content:{required:!0,message:"请输入文章内容",trigger:"blur"},author:{required:!0,message:"请输入作者",trigger:"blur"}},method:"",imgCutOption:{boxWidth:636,boxHeight:520,originalGraph:!1,rate:"4:3"},fileList1:[{url:""}],fileListimg:[],fileList2:[],inputs1:"",inputs2:"",size:"",fileSysType:"",currentFolderId:"",acceptFormate:"",previewUrl:"",cupload:{name:"",percent:0},options2:[],expandTrigger:{label:"name",value:"organId",children:"children"},pid:0,source:"file",duration:"",defaultProps:{children:"children",label:"name"},moduleIdOptions:[]}},computed:Object(s["a"])({},Object(f["c"])({user:function(e){return e.user.user}})),watch:{"form.fullFlag":{handler:function(e){0==e&&(this.form.notifyRecordIds=[])}}},created:function(){},mounted:function(){this.optiones(),this.form.sort=1e3},methods:{getTime:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),a=e.getHours(),o=e.getMinutes(),s=e.getSeconds(),i=t+"-"+this.addZero(r)+"-"+this.addZero(n)+" "+this.addZero(a)+":"+this.addZero(o)+":"+this.addZero(s);return i},addZero:function(e){return e<10?"0"+e:e},optiones:function(){var e=this;m["a"].getOaDeptTree().then((function(t){e.options2=t.data.data})),this.moduleIdOptions=[],m["a"].getForumModulePage({}).then((function(t){t.data.data.records.forEach((function(t){e.moduleIdOptions.push({value:t.id,label:t.name})}))}))},getValue:function(e){this.form.deptId=e?e.organId:""},init:function(e,t){var r=this;this.method=e,this.visible=!0,this.userIds=[],this.form=new d,this.form.author=this.user.id,this.form.authorName=this.user.name,this.form.deptId=this.user.oadept,this.$nextTick(Object(o["a"])(regeneratorRuntime.mark((function n(){var a,o,s,i,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("add"==e){n.next=10;break}return n.next=3,m["a"].queryForumArticleById({id:t.id});case 3:i=n.sent,r.form=i.data.data,r.form.content=i.data.data.articleContent.content,l=JSON.parse(localStorage.getItem("allUser")),r.form.authorName=null===(a=l[null===i||void 0===i||null===(o=i.data)||void 0===o||null===(s=o.data)||void 0===s?void 0:s.author])||void 0===a?void 0:a.name,n.next=11;break;case 10:r.form.publishTime=r.getTime();case 11:case"end":return n.stop()}}),n)}))))},close:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.method="",e.visible=!1;case 2:case"end":return t.stop()}}),t)})))()},validForm:function(e){var t=this;console.log(this.form),this.$refs.form.validate(function(){var r=Object(o["a"])(regeneratorRuntime.mark((function r(n){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!n){r.next=13;break}return t.form.status=e,r.next=4,m["a"].saveForumArticle(t.form);case 4:if(a=r.sent,o=a.data,0==o.code){r.next=8;break}return r.abrupt("return",t.$message.error(o.msg));case 8:t.$message.success(o.msg),t.$parent.$refs.table.init(),t.close(),r.next=14;break;case 13:return r.abrupt("return",!1);case 14:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},formValidated:function(e,t,r){console.log(e,t,r)},getDictList:function(e){return i["a"].getDictList(e)}}}),b=h,g=(r("1838"),r("b179"),r("2877")),v=Object(g["a"])(b,n,a,!1,null,"1e8281ac",null);t["default"]=v.exports},a6f5:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"notification"},[r("div",{staticClass:"content-header"},[r("el-form",{ref:"elForm",staticClass:"filter-form",attrs:{inline:!0,model:e.searchForm}},[r("el-form-item",[r("el-input",{attrs:{placeholder:"帖子名称",clearable:""},model:{value:e.searchForm.title,callback:function(t){e.$set(e.searchForm,"title",t)},expression:"searchForm.title"}})],1),r("el-form-item",[r("el-select",{attrs:{placeholder:"模块",clearable:""},model:{value:e.searchForm.moduleId,callback:function(t){e.$set(e.searchForm,"moduleId",t)},expression:"searchForm.moduleId"}},e._l(e.moduleIdOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"置顶"}},[r("el-select",{attrs:{placeholder:"置顶",clearable:""},model:{value:e.searchForm.topping,callback:function(t){e.$set(e.searchForm,"topping",t)},expression:"searchForm.topping"}},e._l(e.toppingAndEssenceOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"精华"}},[r("el-select",{attrs:{placeholder:"精华",clearable:""},model:{value:e.searchForm.essence,callback:function(t){e.$set(e.searchForm,"essence",t)},expression:"searchForm.essence"}},e._l(e.toppingAndEssenceOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.doSearch}},[e._v("查询")]),r("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:e.resetParams}},[e._v("重置")])],1)],1)],1),r("div",{staticClass:"table"},[r("kr-table",{ref:"table",attrs:{columns:e.columns,fetchFunc:e.getList,searchParams:e.searchForm},on:{"selection-change":e.handleSelectionChange}},[r("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.addOrEdit("add")}}},[e._v("发帖")])],1)])],1),r("formDialog",{ref:"form"})],1)},a=[],o=r("1da1"),s=r("5530"),i=(r("96cf"),r("d81d"),r("99af"),r("159b"),r("b0c0"),r("5228")),l=r("038f"),c=r("f477"),u=r("2f62"),d=(r("4568"),{name:"sys-notification",components:{formDialog:i["default"]},props:{},data:function(){this.$createElement;var e=this;return{toppingAndEssenceOptions:[{value:null,label:"全部"},{value:0,label:"否"},{value:1,label:"是"}],moduleIdOptions:[],notiType:[],searchForm:{ascs:"",author:"",current:1,descs:"create_time",essence:null,moduleId:null,size:20,status:[],titleKeyword:"",topping:null},selectedRows:[],total:100,rows:[],columns:[{prop:"title",label:"标题",align:"center",render:function(e,t){return e("div",{style:"color:var(--defaultTheme)"},[t.title])}},{prop:"author",sortable:!0,label:"作者",align:"center",width:100,render:function(e,t){return e("div",["true"===t.tags?"(匿名) "+t.author:t.author])}},{prop:"moduleId",label:"模块",width:100,sortable:!0,align:"center",render:function(t,r){return t("div",[e.moduleIdOptions.map((function(e){if(e.value===r.moduleId)return t("el-tag",[e.label])}))])}},{prop:"views",label:"浏览量",align:"center",width:100,sortable:!0},{prop:"comments",label:"评论量",width:100,align:"center",sortable:!0},{prop:"sort",label:"排序",width:100,align:"center",sortable:!0},{prop:"publishTime",label:"发布时间",width:180,align:"center",sortable:!0},{prop:"essence",label:"精华",width:70,sortable:!0,render:function(e,t){return e("div",[0===t.essence&&e("el-tag",["否"]),1===t.essence&&e("el-tag",{attrs:{type:"success"}},["是"])])}},{prop:"topping",label:"置顶",width:70,sortable:!0,render:function(e,t){return e("div",[0===t.topping&&e("el-tag",["否"]),1===t.topping&&e("el-tag",{attrs:{type:"success"}},["是"])])}},{label:"操作",headerAlign:"center",prop:"ffff",width:350,fixed:"right",align:"right",render:function(t,r){return t("div",[t("el-button",{on:{click:function(){return e.viewComment(r)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["查看评论"]),t("el-button",{on:{click:function(){return e.addOrEdit("view",r)}},attrs:{type:"text",size:e.size,icon:"krIconfont kr-icon_yulan"}},["查看"]),t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-tianxie",type:"text"},on:{click:function(){return e.addOrEdit("edit",r)}}},["编辑"]),t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-favorite-filling",type:"text"},on:{click:function(){return e.updateToppingById(r)}}},[0==r.topping?"置顶":"取消置顶"]),t("el-button",{attrs:{size:e.size,icon:"krIconfont kr-dianzan",type:"text"},on:{click:function(){return e.updateEssenceById(r)}}},[0==r.essence?"加精":"取消加精"]),t("el-button",{attrs:{size:e.size,icon:" kr-shanchu krIconfont",type:"text"},on:{click:function(){return e.del(r)}},style:"color:red"},["删除"])])}}],showDetail:!1}},computed:Object(s["a"])(Object(s["a"])({},Object(u["c"])({size:function(e){return e.config.defaultSize}})),{},{getList:function(){return l["a"].getForumArticleList}}),watch:{},created:function(){this.getModuleIdOptions()},mounted:function(){},methods:{viewComment:function(e){this.$router.push("/pages/forum/pinglun/index?title=".concat(e.title,"&id=").concat(e.id))},updateEssenceById:function(e){var t=this;this.$confirm("将该帖子进行".concat("1"==e.essence?"取消":"","加精操作?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,l["a"].updateEssenceById({id:e.id,essence:1==e.essence?0:1});case 2:if(n=r.sent,a=n.data,0==a.code){r.next=6;break}return r.abrupt("return",t.$message.error(a.msg));case 6:t.$message({type:"success",message:"成功!"}),t.doSearch();case 8:case"end":return r.stop()}}),r)}))))},updateToppingById:function(e){var t=this;this.$confirm("将该帖子进行".concat(e.topping?"取消":"","置顶操作?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,l["a"].updateToppingById({id:e.id,topping:1==e.topping?0:1});case 2:if(n=r.sent,a=n.data,0==a.code){r.next=6;break}return r.abrupt("return",t.$message.error(a.msg));case 6:t.$message({type:"success",message:"成功!"}),t.doSearch();case 8:case"end":return r.stop()}}),r)}))))},getModuleIdOptions:function(){var e=this;this.moduleIdOptions=[],l["a"].getForumModulePage({}).then((function(t){t.data.data.records.forEach((function(t){e.moduleIdOptions.push({value:t.id,label:t.name})}))}))},resetParams:function(){this.searchForm.moduleId=null,this.searchForm.titleKeyword=null,this.searchForm.essence=null,this.searchForm.topping=null,this.doSearch()},doSearch:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.table.insidePage=1,e.$refs.table.init();case 2:case"end":return t.stop()}}),t)})))()},addOrEdit:function(e,t){this.$refs.form.init(e,t)},handleSelectionChange:function(e){this.selectedRows=e},del:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e instanceof Array||(e=[e]),0!=e.length){r.next=3;break}return r.abrupt("return",t.$message.error("请选择需要删除的项!"));case 3:t.$confirm("此操作将永久删除所选, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.map((function(e){return e.id})),r.next=3,l["a"].deleteForumArticleById({id:n});case 3:if(a=r.sent,o=a.data,console.log(n),0==o.code){r.next=8;break}return r.abrupt("return",t.$message.error(o.msg));case 8:t.$message({type:"success",message:"删除成功!"}),t.doSearch();case 10:case"end":return r.stop()}}),r)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 4:case"end":return r.stop()}}),r)})))()},getDictList:function(e){return c["a"].getDictList(e)},cancelNotification:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.status=0,r.next=3,l["a"].save({id:e.id});case 3:n=r.sent,a=n.data,0==a.code&&(t.$message.success("发布成功！"),t.doSearch()),t.$message.success("撤销成功！"),t.doSearch();case 8:case"end":return r.stop()}}),r)})))()},publicNotification:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.status=1,r.next=3,l["a"].publish({articleId:e.id,status:2});case 3:n=r.sent,a=n.data,0==a.code&&(t.$message.success("发布成功！"),t.doSearch());case 6:case"end":return r.stop()}}),r)})))()}}}),m=d,p=(r("4e78"),r("2877")),f=Object(p["a"])(m,n,a,!1,null,"b7eaf2fe",null);t["default"]=f.exports},b179:function(e,t,r){"use strict";r("1255")},b4fa:function(e,t,r){}}]);