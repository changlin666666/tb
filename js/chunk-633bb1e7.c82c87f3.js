(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-633bb1e7","chunk-9c71abac"],{"038f":function(e,t,a){"use strict";var r=a("5530"),n=a("7bc1");t["a"]={save:function(e){return n["a"].post("/cms/backend/article/save",Object(r["a"])({contributeFlag:1},e))},list:function(e){return n["a"].post("/cms/backend/article/page",e)},del:function(e){return n["a"].get("/cms/backend/article/delete",e)},detail:function(e){return n["a"].get("/cms/backend/article/getById",e)},copyToOtherMenu:function(e){return n["a"].get("/cms/backend/article/copyToOtherMenu",e)},publish:function(e){return n["a"].post("/cms/backend/article/updateArticleStatus",e)},getOaDeptTree:function(e){return n["a"].get("/sys/oadept/getOaDeptTree",e)},getMenuList:function(e){return n["a"].get("/cms/backend/menu/getMenuList",e)},getMenuTreeForAudit:function(e){return n["a"].get("/cms/backend/menu/getMenuTreeForAudit",e)},getCommentPage:function(e){return n["a"].post("/cms/backend/comment/page",e)},deleteComment:function(e){return n["a"].get("/cms/backend/comment/delete",e)},getArticleTileListByMenuNodeIdsAndKeyword:function(e){return n["a"].get("/cms/backend/article/getArticleTileListByMenuNodeIdsAndKeyword",e)},getTheoryEducationMenuTree:function(e){return n["a"].get("/cms/backend/menu/getTheoryEducationMenuTree",e)},getUsableTheoryEducationMenuTree:function(e){return n["a"].get("/cms/backend/menu/getUsableTheoryEducationMenuTree",e)},queryMenuById:function(e){return n["a"].get("/cms/backend/menu/getById",e)},saveMenu:function(e){return n["a"].post("/cms/backend/menu/save",e)},delMenu:function(e){return n["a"].get("/cms/backend/menu/delete",e)},getSpecialSubjectMenuTree:function(e){return n["a"].get("/cms/backend/menu/getSpecialSubjectMenuTree",e)},getRightSubjectMenuTree:function(e){return n["a"].get("/cms/backend/menu/getPopUpMenuTree",e)},getSpecialSubjectMenuTreeUsable:function(e){return n["a"].get("/cms/backend/menu/getUsablePopUpMenuTree",e)},getUsableSpecialSubjectMenuTree:function(e){return n["a"].get("/cms/backend/menu/getUsableSpecialSubjectMenuTree",e)},getForumArticleList:function(e){return n["a"].post("/forum/backend/article/page",e)},deleteForumArticleById:function(e){return n["a"].get("/forum/backend/article/delete",e)},saveForumArticle:function(e){return n["a"].post("/forum/backend/article/save",e)},queryForumArticleById:function(e){return n["a"].get("/forum/backend/article/getById",e)},getForumModulePage:function(e){return n["a"].post("/forum/backend/module/page",e)},updateEssenceById:function(e){return n["a"].get("/forum/backend/article/updateEssenceById",e)},updateToppingById:function(e){return n["a"].get("/forum/backend/article/updateToppingById",e)},getForumCommentList:function(e){return n["a"].post("/forum/backend/comment/page",e)},deleteForumCommentById:function(e){return n["a"].get("/forum/backend/comment/delete",e)},getArticleTileListByKeyword:function(e){return n["a"].get("/forum/backend/article/getArticleTileListByKeyword",e)},getCmsHistoryPage:function(e){return n["a"].post("/cms/backend/history/page",e)},getCmsScorePage:function(e){return n["a"].post("/cms/backend/score/page",e)},getOptoutscorePage:function(e){return n["a"].post("/cms/backend/optoutscore/page",e)},SaveOptoutscore:function(e){return n["a"].post("/cms/backend/optoutscore/save",e)},getAllOaDeptTree:function(e){return n["a"].get("/sys/oadept/getAllOaDeptTree",e)},getBannerList:function(e){return n["a"].post("/cms/backend/banner/page",e)},getBannerDetail:function(e){return n["a"].get("/cms/backend/banner/getById",e)},saveBanner:function(e){return n["a"].post("/cms/backend/banner/save",e)},deleteBannerByid:function(e){return n["a"].get("/cms/backend/banner/delete",e)},getViewBannerByTime:function(e){return n["a"].get("/cms/backend/banner/getByTime",e)}}},"07ac":function(e,t,a){var r=a("23e7"),n=a("6f53").values;r({target:"Object",stat:!0},{values:function(e){return n(e)}})},"0c3f":function(e,t,a){"use strict";var r=a("7bc1");t["a"]={list:function(e){return r["a"].post("/exam/backend/question-classify/page",e)},save:function(e){return r["a"].post("/exam/backend/question-classify/save",e)},del:function(e){return r["a"].get("/exam/backend/question-classify/delete",e)},detail:function(e){return r["a"].get("/exam/backend/question-classify/getById",e)},getQuestionlist:function(e){return r["a"].post("/exam/backend/question/page",e)},getQuestionByIdList:function(e){return r["a"].post("/exam/backend/question/getByIdList",e)},saveQuestion:function(e){return r["a"].post("/exam/backend/question/save",e)},getQuestionDetailById:function(e){return r["a"].get("/exam/backend/question/getById",e)},deleteQuestionById:function(e){return r["a"].get("/exam/backend/question/delete",e)},downloadTemplate:function(e){return r["a"].getBlob("/exam/backend/question/downloadTemplate",e,!0)},getPaperlist:function(e){return r["a"].post("/exam/backend/paper/page",e)},savePaper:function(e){return r["a"].post("/exam/backend/paper/save",e)},getPaperDetailById:function(e){return r["a"].get("/exam/backend/paper/getById",e)},deletePaperById:function(e){return r["a"].get("/exam/backend/paper/delete",e)},openPaperById:function(e){return r["a"].get("/exam/backend/paper/open",e)},closePaperById:function(e){return r["a"].get("/exam/backend/paper/close",e)},getPaperListByNameKeyword:function(e){return r["a"].get("/exam/backend/paper/getPaperListByNameKeyword",e)},paperInspectionPage:function(e){return r["a"].post("/exam/backend/paper/paperInspectionPage",e)},getPaperedList:function(e){return r["a"].post("/exam/backend/user-paper-record/testPaperPage",e)},getUserPaperRecordById:function(e){return r["a"].get("/exam/backend/user-paper-record/getById",e)},marking:function(e){return r["a"].post("/exam/backend/user-paper-record/update",e)},getTestPaperStatistics:function(e){return r["a"].get("/exam/backend/paper/getTestPaperStatistics",e)},getTestPaperStatisticsUserPage:function(e){return r["a"].post("/exam/backend/paper/getTestPaperStatisticsUserPage",e)},getTestPaperStatisticsDeptPage:function(e){return r["a"].get("/exam/backend/paper/getTestPaperStatisticsDeptPage",e)},questionnaireStatistics:function(e){return r["a"].get("/exam/backend/paper/questionnaireStatistics",e)},questionnaireStatisticsForShortAnswerAndFillInTheBlanks:function(e){return r["a"].post("/exam/backend/paper/questionnaireStatisticsForShortAnswerAndFillInTheBlanks",e)},getPaperStatistics:function(e){return r["a"].get("/exam/backend/paper/getById",e)}}},"2c06":function(e,t,a){},"2c62":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.visible,title:"问题管理",width:"80%"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[a("el-steps",{attrs:{active:e.active,simple:""}},[a("el-step",{attrs:{title:"问卷配置",icon:"el-icon-upload"}}),a("el-step",{attrs:{title:"问题配置",icon:"el-icon-picture"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],staticClass:"form-page"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"10em",disabled:"view"==e.method},on:{validate:e.formValidated}},[a("el-form-item",{attrs:{label:"问卷名称:",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入问卷名称",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"截止时间：",prop:"expirationTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"picker-options":e.pickerOptions,align:"right","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择截止时间"},model:{value:e.form.expirationTime,callback:function(t){e.$set(e.form,"expirationTime",t)},expression:"form.expirationTime"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"问卷结果显示方式:",prop:"resultDisplay"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.resultDisplay,callback:function(t){e.$set(e.form,"resultDisplay",t)},expression:"form.resultDisplay"}},e._l(e.resultDisplayOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注：",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注",clearable:""},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"clearfix",staticStyle:{background:"rgb(238, 238, 238)",padding:"10px","line-height":"36px","font-size":"14px"}},[a("div",{staticStyle:{"font-weight":"700"}},[e._v("问卷权限")]),a("el-radio-group",{model:{value:e.form.authorityType,callback:function(t){e.$set(e.form,"authorityType",t)},expression:"form.authorityType"}},[a("el-radio",{attrs:{label:0}},[e._v("完全公开")]),a("el-radio",{attrs:{label:1}},[e._v("部门开放")]),a("el-radio",{attrs:{label:2}},[e._v("指定人员")])],1),0===e.form.authorityType?a("el-alert",{attrs:{title:"开放的，任何人都可以进行问卷！",type:"success"}}):e._e(),1===e.form.authorityType?[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.deptFilterText,callback:function(t){e.deptFilterText=t},expression:"deptFilterText"}}),a("el-tree",{ref:"deptTree",staticClass:"filter-tree",staticStyle:{"margin-top":"20px"},attrs:{data:e.deptOptions,props:e.defaultProps,"default-expand-all":"","show-checkbox":"","default-expanded-keys":e.defaultTreeList,"filter-node-method":e.deptFilterNode,nodeKey:"organId"},on:{"check-change":e.deptCheckChange}})]:e._e(),2===e.form.authorityType?a("div",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"部门:",prop:"deptId","label-width":"4em"}},[a("kr-tree-select",{staticStyle:{width:"100%"},attrs:{data:e.deptOptionsAndAll,props:e.defaultProps,nodeKey:"organId"},on:{getValue:e.getDeptId},model:{value:e.searchSelectedUserForm.deptId,callback:function(t){e.$set(e.searchSelectedUserForm,"deptId",t)},expression:"searchSelectedUserForm.deptId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"搜索用户姓名"},model:{value:e.searchSelectedUserForm.name,callback:function(t){e.$set(e.searchSelectedUserForm,"name",t)},expression:"searchSelectedUserForm.name"}})],1),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"top10"},[a("kr-table",{ref:"table",attrs:{columns:e.columns,fetchFunc:e.getSelectedList,tableOptions:{"highlight-current-row":!0},searchParams:e.searchSelectedUserForm},on:{"selection-change":e.handleSelectionChange}},[a("div",{attrs:{slot:"handleButtons"},slot:"handleButtons"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){return e.addOrEditUser()}}},[e._v("新增")]),a("el-button",{attrs:{icon:"el-icon-delete",type:"danger",size:"small",plain:"",disabled:0==e.selectedUserRows.length},on:{click:e.deleteUser}},[e._v("删除("+e._s(e.selectedUserRows.length)+") ")])],1)])],1)])],1):e._e()],2)])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],staticClass:"form-page"},[a("el-card",{staticClass:"box-card"},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"form2",attrs:{model:e.form,rules:e.rules,"label-width":"8em",disabled:"view"==e.method},on:{validate:e.formValidated}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"问题总数:",prop:"total"}},[a("el-input",{attrs:{disabled:"",clearable:""},model:{value:e.selectedQuestionList.length,callback:function(t){e.$set(e.selectedQuestionList,"length",t)},expression:"selectedQuestionList.length"}})],1)],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:e.addQuestionHandler}},[a("i",{staticClass:"el-icon-plus el-icon--left"}),e._v("添加新题 ")])],1)],1)],1)],1),a("h3",{staticClass:"question-list"},[e._v("题目列表")]),a("el-card",{staticClass:"box-card"},e._l(e.selectedQuestionList,(function(t,r){return a("div",{key:t.id,staticClass:"clearfix"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:18}},[a("div",{staticClass:"question-top"},[a("div",{staticClass:"question-index"},[e._v(e._s(r+1))]),0===t.type?a("el-tag",{attrs:{effect:"dark"}},[e._v("单选题")]):e._e(),1===t.type?a("el-tag",{attrs:{effect:"dark",type:"success"}},[e._v("多选题")]):e._e(),2===t.type?a("el-tag",{attrs:{effect:"dark",color:"rgb(128,7,183)",type:"info"}},[e._v("判断题")]):e._e(),3===t.type?a("el-tag",{attrs:{effect:"dark",type:"warning"}},[e._v("简答题")]):e._e(),4===t.type?a("el-tag",{attrs:{effect:"dark",type:"danger"}},[e._v("填空题")]):e._e(),a("div",{staticClass:"question-title"},[e._v(" "+e._s(t.content)+" ")])],1),a("ul",{staticClass:"question-bottom"},e._l(t.answers,(function(t,r){return a("li",{key:t.id,staticClass:"question-answer"},[a("span",{staticClass:"tag"},[e._v(e._s(e.getFromCharCode(r)))]),a("p",{staticClass:"content"},[e._v(e._s(t.content))]),t.correct?a("span",{staticClass:"right"},[a("i",{staticClass:"el-icon-success",staticStyle:{color:"rgb(26, 172, 26)"}}),e._v(" 答案 ")]):e._e()])})),0),t.analysis?a("div",{staticClass:"question-analysis"},[a("div",[e._v("大题解析：")]),a("p",[e._v(" "+e._s(t.analysis)+" ")])]):e._e()]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"listopt"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"移除本题",placement:"top"}},[a("el-button",{attrs:{disabled:"view"==e.method,type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.removeQue(r)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"排序上移",placement:"top"}},[a("el-button",{attrs:{disabled:"view"==e.method,icon:"el-icon-top",circle:"",size:"mini"},on:{click:function(t){return e.moveTop(r)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"排序下移",placement:"top"}},[a("el-button",{attrs:{disabled:"view"==e.method,icon:"el-icon-bottom",circle:"",size:"mini"},on:{click:function(t){return e.moveBottom(r)}}})],1)],1)])],1)],1)})),0)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{on:{click:e.activeHandler}},[e._v(e._s(1===e.active?"下一步":"上一步"))]),2===e.active&&"view"!=e.method?a("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{type:"primary"},on:{click:function(t){return e.validForm()}}},[e._v("保存 ")]):e._e()],1),a("el-dialog",{attrs:{"append-to-body":"",title:"选择用户",width:"60%",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("div",{staticClass:"clearfix"},[a("el-col",{attrs:{span:10}},[a("kr-tree-select",{staticStyle:{width:"100%"},attrs:{data:e.deptOptionsAndAll,props:e.defaultProps,nodeKey:"organId"},on:{getValue:e.getDeptId},model:{value:e.searchAllUserForm.deptId,callback:function(t){e.$set(e.searchAllUserForm,"deptId",t)},expression:"searchAllUserForm.deptId"}})],1),a("el-col",{attrs:{span:10}},[a("el-input",{attrs:{placeholder:"搜索用户姓名"},model:{value:e.searchAllUserForm.name,callback:function(t){e.$set(e.searchAllUserForm,"name",t)},expression:"searchAllUserForm.name"}})],1),a("el-col",{staticStyle:{"margin-bottom":"10px","text-align":"right"},attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveSelectedUser}},[e._v("确认"+e._s(e.allUserSelectedRows.length)+"项")])],1),a("el-col",{attrs:{span:24}},[a("kr-table",{ref:"alltable",attrs:{columns:e.columns,tableOptions:{"highlight-current-row":!0},fetchFunc:e.getAllUserList,searchParams:e.searchAllUserForm},on:{handleCurrentChange:e.handleCurrentChange,"selection-change":e.allUserHandleSelectionChange}})],1)],1)]),a("addQuestionTable",{ref:"addQuestionTable",on:{saveQuestion:e.saveQuestion}})],1)},n=[],i=a("2909"),s=a("1da1"),l=a("5530"),o=(a("96cf"),a("b0c0"),a("4de4"),a("159b"),a("d81d"),a("07ac"),a("99af"),a("d3b7"),a("c740"),a("a434"),a("f477")),c=a("9f0d"),u=a("e63d"),d=a("0c3f"),p=a("66de"),f=a("038f"),m=a("85b6"),h=a("2f62"),g={components:{userSelect:c["a"],krUpload:m["a"],addQuestionTable:p["default"]},props:{allClassifyTypeList:{type:Array,default:function(){return[]}}},data:function(){this.$createElement;return{dictUtils:o["a"],deptFilterText:"",NameFilterText:"",selectedList:[],dialogTableVisible:!1,allUserList:[],allUserListYiYong:[],pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},defaultTreeList:[],allUserMap:{},searchSelectedUserForm:{name:"",deptId:null},searchAllUserForm:{name:"",deptId:null},selectedUserRows:[],allUserSelectedRows:[],selectedQuestionList:[],columns:[{prop:"name",label:"姓名",render:function(e,t){return e("div",[t.name])}},{prop:"oadeptName",label:"部门",render:function(e,t){return e("div",[t.oadeptName])}}],resultDisplayOptions:[{value:1,label:"显示问卷统计结果"},{value:2,label:"不显示"}],visible:!1,deptOptions:[],deptOptionsAndAll:[],defaultProps:{children:"children",label:"name",value:"organId"},form:new u["a"],rules:{name:{required:!0,message:"请输入问卷名称",trigger:"blur"},expirationTime:{required:!0,message:"请选择截止时间",trigger:"blur"},content:{required:!0,message:"请输入题目内容",trigger:"blur"}},method:"",active:1}},computed:Object(l["a"])({},Object(h["c"])({user:function(e){return e.user.user}})),watch:{deptFilterText:function(e){this.$refs.deptTree.filter(e)},"searchSelectedUserForm.deptId":{handler:function(e){this.$refs.table.insidePage=1,this.$refs.table.init()}},"searchSelectedUserForm.name":{handler:function(e){this.$refs.table.insidePage=1,this.$refs.table.init()}},"searchAllUserForm.deptId":{handler:function(e){this.$refs.alltable.insidePage=1,this.$refs.alltable.init()}},"searchAllUserForm.name":{handler:function(e){this.$refs.alltable.insidePage=1,this.$refs.alltable.init()}}},created:function(){this.getOaDeptTree(),this.getAllUser()},mounted:function(){},methods:{init:function(e,t){var a=this;this.method=e,this.visible=!0,this.active=1,this.form=new u["a"],this.$nextTick(Object(s["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if("add"==e){r.next=12;break}return a.selectedList=[],r.next=4,d["a"].getPaperDetailById({id:t.id});case 4:n=r.sent,a.form=n.data.data,a.selectedQuestionList=a.form.questions,a.form.questions.forEach((function(e){e.id=e.questionId})),1===a.form.authorityType&&(a.defaultTreeList=a.form.authorities.map((function(e){return e.authorityId})),a.$nextTick((function(){a.$refs.deptTree.setCheckedKeys(a.defaultTreeList)}))),2===a.form.authorityType&&a.form.authorities.forEach((function(e){a.selectedList.push(a.allUserMap[e.authorityId])})),r.next=13;break;case 12:a.selectedQuestionList=[];case 13:case"end":return r.stop()}}),r)}))))},addQuestionHandler:function(){var e=this.selectedQuestionList.map((function(e){return e.id}));console.log(e),this.$refs.addQuestionTable.init(e)},activeHandler:function(){var e=this;1===this.active?this.$refs.form.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=4;break}e.active=2,t.next=5;break;case 4:return t.abrupt("return",!1);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.active=1},addOrEditUser:function(){var e=this;this.dialogTableVisible=!0,this.allUserListYiYong=this.getDifferenceSetA(this.allUserList,this.selectedList),this.$nextTick((function(){e.searchAllUserForm.deptId=null,e.searchAllUserForm.name="",e.$refs.alltable.refresh()}))},getAllUser:function(){this.allUserMap=JSON.parse(localStorage.getItem("allUser")),this.allUserList=Object.values(JSON.parse(localStorage.getItem("allUser"))),this.allUserList=this.allUserList.filter((function(e){if(e.id.length>30)return!0}))},getDifferenceSetA:function(e,t){return e=e.map(JSON.stringify),t=t.map(JSON.stringify),e.concat(t).filter((function(e,t,a){return a.indexOf(e)===a.lastIndexOf(e)})).map(JSON.parse)},addAppointUser:function(){},handleSizeChange:function(e){console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){console.log("当前页: ".concat(e))},deptCheckChange:function(e,t,a){console.log(e,t,a)},getOaDeptTree:function(){var e=this;f["a"].getOaDeptTree().then((function(t){e.deptOptions=t.data.data,e.deptOptionsAndAll=JSON.parse(JSON.stringify(t.data.data)),e.deptOptionsAndAll.unshift({name:"全部",organId:null})}))},getDeptId:function(e){this.form.deptId=e?e.organId:""},deptFilterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},getSelectedList:function(e){var t=this,a=e.current,r=void 0===a?1:a,n=e.size,i=void 0===n?10:n,s=this.searchSelectedUserForm,l=s.deptId,o=s.name,c=[];return new Promise((function(e){c=l&&o?t.selectedList.filter((function(e){if(e.oadept.indexOf(l)>=0&&e.name.indexOf(o)>=0)return!0})):l?t.selectedList.filter((function(e){if(e.oadept===l)return!0})):o?t.selectedList.filter((function(e){if(e.name.indexOf(o)>=0)return!0})):t.selectedList;var a=c.filter((function(e,t){return t<i*r&&t>=i*(r-1)})),n={data:{code:0,msg:"ok",isSuccess:!0,extra:null,isError:!1,data:{current:r,records:a,size:i,total:c.length}}};e(n)}))},getAllUserList:function(e){var t=this,a=e.current,r=void 0===a?1:a,n=e.size,i=void 0===n?10:n,s=this.searchAllUserForm,l=s.deptId,o=s.name,c=[];return new Promise((function(e){c=l&&o?t.allUserListYiYong.filter((function(e){if(e.oadept.indexOf(l)>=0&&e.name.indexOf(o)>=0)return!0})):l?t.allUserListYiYong.filter((function(e){if(e.oadept===l)return!0})):o?t.allUserListYiYong.filter((function(e){if(e.name.indexOf(o)>=0)return!0})):t.allUserListYiYong;var a=c.filter((function(e,t){return t<i*r&&t>=i*(r-1)})),n={data:{code:0,msg:"ok",isSuccess:!0,extra:null,isError:!1,data:{current:r,records:a,size:i,total:c.length}}};e(n)}))},handleSelectionChange:function(e){this.selectedUserRows=e},allUserHandleSelectionChange:function(e){this.allUserSelectedRows=e},arrDistinctByProp:function(e,t){return e.filter((function(e,a,r){return r.findIndex((function(a){return a[t]==e[t]}))===a}))},getFromCharCode:function(e){return String.fromCharCode(64+parseInt(1+e))},saveSelectedUser:function(){this.selectedList=[].concat(Object(i["a"])(this.selectedList),Object(i["a"])(this.allUserSelectedRows)),this.selectedList=this.arrDistinctByProp(this.selectedList,"id"),this.$refs.table.init(),this.dialogTableVisible=!1},deleteUser:function(){var e=this;this.selectedUserRows.forEach((function(t){e.selectedList.splice(e.selectedList.findIndex((function(e){return e.id===t.id})),1)})),this.$refs.table.init()},close:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.method="",e.visible=!1;case 2:case"end":return t.stop()}}),t)})))()},validForm:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.selectedQuestionList.length<1)){t.next=3;break}return e.$message.error("问题不可为空，请添加问题！"),t.abrupt("return",!1);case 3:t.t0=e.form.authorityType,t.next=0===t.t0?6:1===t.t0?8:2===t.t0?11:13;break;case 6:return e.form.authorities=[],t.abrupt("break",13);case 8:return a=e.$refs.deptTree.getCheckedNodes(),e.form.authorities=a.map((function(t){return{authorityId:t.organId,paperId:e.form.id?e.form.id:null,paperType:1}})),t.abrupt("break",13);case 11:return e.form.authorities=e.selectedList.map((function(t){return{authorityId:t.id,paperId:e.form.id?e.form.id:null,paperType:1}})),t.abrupt("break",13);case 13:return e.form.questions=e.selectedQuestionList.map((function(t,a){return{paperId:e.form.id?e.form.id:null,questionId:t.id,score:t.score,sort:a+1}})),console.log(e.form),t.next=17,d["a"].savePaper(e.form);case 17:if(r=t.sent,n=r.data,0==n.code){t.next=21;break}return t.abrupt("return",e.$message.error(n.msg));case 21:e.$message.success(n.msg),e.$parent.$refs.table.init(),e.close();case 24:case"end":return t.stop()}}),t)})))()},saveQuestion:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.map((function(e){return e.id})),a.next=3,d["a"].getQuestionByIdList(r);case 3:if(n=a.sent,s=n.data,0==s.code){a.next=7;break}return a.abrupt("return",t.$message.error(s.msg));case 7:l=s.data,l.forEach((function(e){return t.$set(e,"score",5)})),t.selectedQuestionList=[].concat(Object(i["a"])(t.selectedQuestionList),Object(i["a"])(null===s||void 0===s?void 0:s.data));case 10:case"end":return a.stop()}}),a)})))()},removeQue:function(e){this.selectedQuestionList.splice(e,1)},moveTop:function(e){e&&(this.selectedQuestionList[e]=this.selectedQuestionList.splice(e-1,1,this.selectedQuestionList[e])[0])},moveBottom:function(e){this.selectedQuestionList.length-1!==e&&(this.selectedQuestionList[e+1]=this.selectedQuestionList.splice(e,1,this.selectedQuestionList[e+1])[0])},test:function(e,t,a){console.log(e,t,a)},formValidated:function(e,t,a){console.log(e,t,a)},getDictList:function(e){return o["a"].getDictList(e)}}},b=g,y=(a("45b6"),a("63a6"),a("2877")),v=Object(y["a"])(b,r,n,!1,null,"3592b4c0",null);t["default"]=v.exports},"45b6":function(e,t,a){"use strict";a("2c06")},6395:function(e,t,a){"use strict";a("c502")},"63a6":function(e,t,a){"use strict";a("ed07")},"66de":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":"",title:"选择试题",width:"80%",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-form",{ref:"elForm",staticClass:"filter-form",attrs:{"append-to-body":"",inline:!0,model:e.searchForm}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"所属分类"},model:{value:e.searchForm.classifyId,callback:function(t){e.$set(e.searchForm,"classifyId",t)},expression:"searchForm.classifyId"}},e._l(e.allClassifyTypeListAndAll,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"试题类型"},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},e._l(e.questionTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"题目关键字",clearable:""},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.doSearch}},[e._v("查询")]),a("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:e.resetParams}},[e._v("重置")]),a("el-button",{attrs:{type:"success"},on:{click:e.saveQuestion}},[e._v("确认"+e._s(e.selectedRows.length)+"项")])],1)],1),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"table"},[a("kr-table",{ref:"table",attrs:{tableOptions:{"highlight-current-row":!0},columns:e.columns,fetchFunc:e.getList,searchParams:e.searchForm},on:{"selection-change":e.handleSelectionChange}})],1)])],1)},n=[],i=a("1da1"),s=(a("159b"),a("b0c0"),a("96cf"),a("0c3f")),l={props:{width:{type:String,default:"50%"},treeData:{type:Array,default:function(){return[]}},treeProps:{type:Object,default:function(){return{children:"children",label:"name",disabled:"disabled"}}}},watch:{},computed:{getList:function(){return s["a"].getQuestionlist}},created:function(){this.getQuestionClassifyType()},data:function(){this.$createElement;var e=this;return{treeData2:[],dialogTableVisible:!1,nodeIds:"",parentId:"",questionTypeOptions:[{value:null,label:"全部题型"},{value:0,label:"单选题"},{value:1,label:"多选题"},{value:2,label:"判断题"},{value:3,label:"简答题"},{value:4,label:"填空题"}],method:"",selectedRows:[],searchForm:{ascs:"",classifyId:null,current:1,exclusionIds:[],descs:"create_time",keyword:"",paperType:0,size:20,type:null},allClassifyTypeMap:{},allClassifyTypeList:[],allClassifyTypeListAndAll:[],columns:[{prop:"content",label:"题目内容",render:function(e,t){return e("div",{style:"color:var(--defaultTheme)"},[t.content])}},{prop:"classifyId",label:"所属分类",align:"center",width:200,sortable:!0,render:function(t,a){return t("div",[e.allClassifyTypeMap[a.classifyId]])}},{prop:"type",label:"试题类型",align:"center",width:200,sortable:!0,render:function(e,t){return e("div",[0===t.type&&e("el-tag",{attrs:{effect:"dark"}},["单选题"]),1===t.type&&e("el-tag",{attrs:{effect:"dark",type:"success"}},["多选题"]),2===t.type&&e("el-tag",{attrs:{effect:"dark",color:"rgb(128,7,183)",type:"info"}},["判断题"]),3===t.type&&e("el-tag",{attrs:{effect:"dark",type:"warning"}},["简答题"]),4===t.type&&e("el-tag",{attrs:{effect:"dark",type:"danger"}},["填空题"])])}},{prop:"createTime",label:"创建时间",width:200,align:"center",sortable:!0}],typeList:[],rules:{menuType:[{required:!0,message:"模块类型不能为空",trigger:"blur"}],name:[{required:!0,message:"名称不能为空",trigger:"blur"}]},id:"",title:""}},methods:{init:function(e){this.dialogTableVisible=!0,this.searchForm.keyword="",this.searchForm.classifyId=null,this.searchForm.type=null,this.searchForm.exclusionIds=e,this.doSearch()},doSearch:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.table.init();case 1:case"end":return t.stop()}}),t)})))()},resetParams:function(){this.searchForm.keyword="",this.searchForm.classifyId=null,this.searchForm.type=null,this.doSearch()},getQuestionClassifyType:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].list({ascs:"",classifyType:0,current:1,descs:"",keyword:"",size:9999});case 2:if(n=t.sent,i=n.data,0==i.code){t.next=6;break}return t.abrupt("return",e.$message.error(i.msg));case 6:e.allClassifyTypeList=null===i||void 0===i||null===(a=i.data)||void 0===a?void 0:a.records,e.allClassifyTypeListAndAll=JSON.parse(JSON.stringify(e.allClassifyTypeList)),e.allClassifyTypeListAndAll.unshift({id:null,name:"全部分类"}),null===i||void 0===i||null===(r=i.data)||void 0===r||r.records.forEach((function(t){var a=t.id;e.allClassifyTypeMap[a]=t.name}));case 10:case"end":return t.stop()}}),t)})))()},handleSelectionChange:function(e){this.selectedRows=e},choseIcon:function(e){this.form.icon=e},getValue:function(e){this.form.parentNodeIds=e.nodeIds},saveQuestion:function(){this.$emit("saveQuestion",this.selectedRows),this.dialogTableVisible=!1}}},o=l,c=(a("8aed"),a("2877")),u=Object(c["a"])(o,r,n,!1,null,"4608e280",null);t["default"]=u.exports},"6f53":function(e,t,a){var r=a("83ab"),n=a("df75"),i=a("fc6a"),s=a("d1e7").f,l=function(e){return function(t){var a,l=i(t),o=n(l),c=o.length,u=0,d=[];while(c>u)a=o[u++],r&&!s.call(l,a)||d.push(e?[a,l[a]]:l[a]);return d}};e.exports={entries:l(!0),values:l(!1)}},"85b6":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload",style:{"--drag-width":e.dragOption.width||"360px","--drag-height":e.dragOption.height||"220px"}},["picture-card"===e.$attrs["list-type"]?a("el-upload",e._b({ref:"upload",attrs:{"on-change":e.uploadImgsChange,"on-success":e.uploadSuccess,headers:{token:e.$store.state.user.user.token}},scopedSlots:e._u([{key:"file",fn:function(t){var r=t.file;return a("div",{},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:r.url,alt:""}}),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(r)}}},[a("i",{staticClass:"el-icon-zoom-in"})]),e.imgEditEnable&&e.isView?a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleEditImg(r)}}},[a("i",{staticClass:"el-icon-edit-outline"})]):e._e(),e.isView?a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(r)}}},[a("i",{staticClass:"el-icon-delete"})]):e._e()])])}}],null,!1,863019275)},"el-upload",e.$attrs,!1),[a("i",{staticClass:"el-icon-plus"})]):a("el-upload",e._b({ref:"upload",attrs:{headers:{token:e.$store.state.user.user.token}},on:{"on-success":e.uploadImgsSuccess}},"el-upload",e.$attrs,!1),[e.$attrs.drag?a("div",{staticClass:"drag-tooltip"},[a("i",{staticClass:"el-icon-upload drag-tooltip-icon"}),a("div",{staticClass:"drag-tooltip-text"},[e._v(" 将文件拖到此处，或 "),a("em",[e._v("点击上传")])]),e.tooltip?a("div",{staticClass:"tooltip-text"},[e._v("支持扩展名："+e._s(e.tooltip))]):e._e()]):e._e(),a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),!e.$attrs.drag&&e.tooltip?a("div",{staticClass:"tooltip-text",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.tooltip))]):e._e()],1),a("el-dialog",{attrs:{title:"图片预览",visible:e.dialogVisible,top:"3vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),a("el-dialog",{attrs:{title:"图片剪裁",visible:e.ImgCutterData.visible,"append-to-body":!0},on:{"update:visible":function(t){return e.$set(e.ImgCutterData,"visible",t)}}},[e.ImgCutterData.visible?a("img-cutter",e._b({ref:"ImgCutter",attrs:{showChooseBtn:!1,isModal:!1},on:{loaded:e.imgCutterLoaded,cutDown:e.imgCutDown,onClearAll:function(t){e.ImgCutterData.visible=!1},changeAllreadyCut:e.changeAllreadyCut}},"img-cutter",e.imgCutOption,!1)):e._e()],1)],1)},n=[],i=(a("d3b7"),a("3ca3"),a("ddb0"),a("b0c0"),function(){return a.e("ImgCutter").then(a.bind(null,"447d"))}),s={name:"kr-upload",components:{ImgCutter:i},props:{tooltip:String,isView:{type:Boolean,default:!0},uploadType:{type:String,default:"file"},dragOption:{type:Object,default:function(){return{width:"360px",height:"220px"}}},imgCutOption:{type:Object,default:function(){return{boxHeight:400,boxWidth:800,originalGraph:!1,rate:null}}},imgEditEnable:{type:Boolean,default:!1}},data:function(){return{isAlreadyCut:!1,dialogImageUrl:"",dialogVisible:!1,ImgCutterData:{loadImgCutter:!1,visible:!1,file:null},uid:""}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{changeAllreadyCut:function(e){this.isAlreadyCut=e},uploadSuccess:function(e,t,a){this.loading=!1},uploadImgsChange:function(e,t){!0!==this.$attrs.multiple&&(this.$refs.upload._data.uploadFiles=[e]),this.isAlreadyCut||this.uid===e.uid||(this.ImgCutterData.visible=!0,this.ImgCutterData.file=e),this.uid=e.uid},handleRemove:function(e){this.$attrs["on-remove"](e,this.$refs.upload._data.uploadFiles),this.$emit("remove")},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleEditImg:function(e){e.name||(e.name="无名称.png"),this.ImgCutterData.file=e,this.ImgCutterData.visible=!0},imgCutterLoaded:function(){console.log(),this.$refs.ImgCutter.handleOpen(this.ImgCutterData.file)},imgCutDown:function(e){this.ImgCutterData.file.raw=e.file,this.ImgCutterData.file.raw.uid=this.ImgCutterData.file.uid,this.ImgCutterData.file.url=e.dataURL,this.ImgCutterData.file.size=e.file.size,this.ImgCutterData.file.status="ready",this.ImgCutterData.visible=!1,!1!==this.$attrs["auto-upload"]&&this.$refs.upload.submit(),this.$emit("cutDown",this.ImgCutterData.file)}}},l=s,o=(a("6395"),a("2877")),c=Object(o["a"])(l,r,n,!1,null,"b560955c",null);t["a"]=c.exports},"8aed":function(e,t,a){"use strict";a("bb01")},bb01:function(e,t,a){},c502:function(e,t,a){},d4ec:function(e,t,a){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a.d(t,"a",(function(){return r}))},e63d:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("d4ec"),n=a("ade3"),i=function e(){Object(r["a"])(this,e),Object(n["a"])(this,"authorities",[]),Object(n["a"])(this,"authorityType",0),Object(n["a"])(this,"delFlag",0),Object(n["a"])(this,"expirationTime",""),Object(n["a"])(this,"id",null),Object(n["a"])(this,"limitCount",1),Object(n["a"])(this,"name",""),Object(n["a"])(this,"notice",""),Object(n["a"])(this,"paperType",0),Object(n["a"])(this,"questions",[]),Object(n["a"])(this,"remarks",""),Object(n["a"])(this,"resultDisplay",1),Object(n["a"])(this,"scoreComplete",0),Object(n["a"])(this,"status",0)}},ed07:function(e,t,a){}}]);