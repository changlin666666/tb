(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d9a2942","chunk-2d0af849"],{"03a1":function(e,t,a){e.exports=a.p+"img/u709.d3b7628e.png"},"0f52":function(e,t,a){"use strict";var r=a("7bc1");t["a"]={list:function(e){return r["a"].post("/data-share/api/page",e)},use:function(e){return r["a"].get("/data-share/api/updateUsableById",e)},add:function(e){return r["a"].post("/data-share/api/add",e)},save:function(e){return r["a"].post("/data-share/api/edit",e)},del:function(e){return r["a"].get("/data-share/api/deleteById",e)},getIdentity:function(e){return r["a"].get("/data-share/api/getIdentity",e)},detail:function(e){return r["a"].get("/data-share/api/get",e)},test:function(e){return r["a"].post("/data-share/api/test",e)},doc:function(e){return r["a"].get("/data-share/api/showDoc",e)}}},2936:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"group"},[r("div",{staticClass:"header"},[r("span",[e._v("应用管理")]),r("span",{staticClass:"icons"},[r("el-button-group",[r("el-tooltip",{attrs:{content:"添加应用",placement:"top"}},[r("el-button",{staticClass:"addIcon",attrs:{icon:"el-icon-plus",size:"mini",type:"text"},on:{click:e.addGroup}})],1)],1)],1)]),r("div",{staticClass:"treeselect-box"},[r("div",{staticClass:"tree-box"},e._l(e.treeData,(function(t,n){return r("div",{key:n,staticClass:"item",class:e.currentGroup.id==t.id?"active":"",on:{click:function(a){return e.changeGroup(t)}}},[r("img",{attrs:{src:a("03a1"),alt:""}}),e._v(" "+e._s(t.name)+" ")])})),0)])]),r("div",{staticClass:"right"},[r("div",{staticClass:"top"},[r("div",{staticClass:"title"},[e._v(e._s(e.currentGroup.name))]),r("el-row",{staticClass:"content"},[r("el-row",{staticClass:"row"},[r("el-col",{staticClass:"gray",attrs:{span:7}},[e._v(" 应用编号："+e._s(e.currentGroup.id)+" ")]),r("el-col",{staticClass:"gray",attrs:{span:7}},[e._v(" 请求类型："+e._s(e.getType(e.currentGroup.authType))+" ")]),r("el-col",{staticClass:"gray",attrs:{span:7}},[e._v(" 有效期："+e._s(e.currentGroup.expirationTime)+" ")]),r("el-col",{staticClass:"gray",attrs:{span:7}},[e._v(" 应用AK："+e._s(e.currentGroup.accessKey)+" ")]),0==e.currentGroup.authType?r("el-col",{staticClass:"gray",attrs:{span:7}},[e._v(" ip白名单："),e._l(e.currentGroup.ipWhiteList.split(","),(function(t){return r("el-tag",{key:t,staticStyle:{"margin-right":"4px"},attrs:{size:"small"}},[e._v(e._s(t))])}))],2):e._e(),1==e.currentGroup.authType?r("el-col",{staticClass:"gray",attrs:{span:7}},[e._v(" sn密钥："+e._s(e.currentGroup.secretKey)+" ")]):e._e(),2==e.currentGroup.authType?r("el-col",{staticClass:"gray",attrs:{span:7}},[e._v(" 应用token："+e._s(e.currentGroup.token)+" ")]):e._e(),r("el-col",{staticClass:"btns",attrs:{span:10}},[r("el-button",{attrs:{size:"small",icon:"el-icon-edit",type:"primary"},on:{click:e.edit}},[e._v("编辑")]),r("el-button",{attrs:{size:"small",icon:"el-icon-delete",type:"danger"},on:{click:e.del}},[e._v("删除")])],1),r("el-col",{staticClass:"gray",attrs:{span:24}},[e._v(" 备注："+e._s(e.currentGroup.remarks)+" ")])],1)],1)],1),r("div",{staticClass:"bottom"},[r("div",{staticClass:"title"},[e._v(" 接口权限配置 "),r("el-button",{attrs:{size:"mini",type:"primary",plain:"",disabled:0==e.selection.length},on:{click:e.saveAuth}},[e._v("确认授权")])],1),r("div",{staticClass:"content"},[r("el-table",{ref:"table",attrs:{data:e.tableData,lazy:"",load:e.load,"tree-props":e.treeProps,"row-key":"id",border:"",stripe:"",size:e.size},on:{"selection-change":e.changeSelection}},[r("el-table-column",{attrs:{type:"selection"}}),r("el-table-column",{attrs:{label:"接口/目录名称",prop:"name"}}),r("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.nodeId?"目录":0==t.row.resourceType?"模型接口":"外部资源接口"))])]}}])}),r("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),r("el-table-column",{attrs:{label:"状态",prop:"usable",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:0==t.row.usable?"danger":"success"}},[e._v(e._s(0==t.row.usable?"禁用":"正常"))])]}}])})],1)],1)])]),r("groupForm",{ref:"groupForm"})],1)},n=[],s=a("2909"),c=a("1da1"),i=a("5530"),o=a("b85c"),u=(a("d81d"),a("99af"),a("96cf"),a("4276")),l=a("0f52"),d=a("70da"),p=a("148a"),h=a("2f62");function f(e,t){var a,r=Object(o["a"])(e);try{for(r.s();!(a=r.n()).done;){var n=a.value;if(t.authId==n.id)return n;if(n.children&&n.children.length>0){var s=f(n.children,t);if(s)return s}}}catch(c){r.e(c)}finally{r.f()}}var g={components:{groupForm:u["default"]},data:function(){return{treeData:[],tableData:[],treeProps:{hasChildren:"hasChildren",children:"children"},currentGroup:"",selection:[]}},mounted:function(){this.init()},computed:Object(i["a"])({},Object(h["c"])({size:function(e){return e.config.defaultSize}})),methods:{init:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.initGroup();case 2:e.initList();case 3:case"end":return t.stop()}}),t)})))()},changeSelection:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.selection=e;case 1:case"end":return a.stop()}}),a)})))()},saveAuth:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["a"].auth(e.selection.map((function(t){return{appId:e.currentGroup.id,authId:t.id,authType:t.nodeId?2:0==t.resourceType?0:1}})));case 2:if(a=t.sent,r=a.data,0==r.code){t.next=6;break}return t.abrupt("return",e.$message.error(r.msg));case 6:e.$message.success(r.msg);case 7:case"end":return t.stop()}}),t)})))()},initGroup:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["a"].list({current:1,size:999});case 2:a=t.sent,r=a.data,e.treeData=r.data.records,e.currentGroup=e.treeData[0];case 6:case"end":return t.stop()}}),t)})))()},initList:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].tree();case 2:return a=t.sent,r=a.data,t.next=6,e.addChildren(r.data);case 6:e.checkedNodes(),e.tableData=r.data;case 8:case"end":return t.stop()}}),t)})))()},checkedNodes:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s,c,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$refs.table.clearSelection(),t.next=3,p["a"].getAuth({appId:e.currentGroup.id});case 3:a=t.sent,r=a.data,n=Object(o["a"])(r.data);try{for(n.s();!(s=n.n()).done;)c=s.value,i=f(e.tableData,c),i&&e.$refs.table.toggleRowSelection(i)}catch(u){n.e(u)}finally{n.f()}case 7:case"end":return t.stop()}}),t)})))()},addChildren:function(e){var t,a=Object(o["a"])(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;r.hasChildren=!0,r.children&&this.addChildren(r.children)}}catch(n){a.e(n)}finally{a.f()}},load:function(e,t,a){var r=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,c,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["a"].list({catalogId:e.id,current:1,size:5e3,usable:"",name:"",keyword:"",resourceType:"",identity:""});case 2:if(n=t.sent,c=n.data,!(c.data.records.length>0)){t.next=12;break}return i=[],i=e.children?[].concat(Object(s["a"])(c.data.records),Object(s["a"])(e.children)):c.data.records,r.$set(e,"children",i),t.next=10,a(e.children);case 10:t.next=13;break;case 12:a(e.children&&e.children.length>0?e.children:[]);case 13:r.$nextTick((function(){r.checkedNodes()}));case 14:case"end":return t.stop()}}),t)})))()},addGroup:function(){this.$refs.groupForm.init("add")},changeGroup:function(e){this.currentGroup=e},edit:function(){this.$refs.groupForm.init("edit",this.currentGroup.id,this.currentGroup)},del:function(){var e=this;this.$confirm("此操作将永久删除所选, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(c["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["a"].del({id:e.currentGroup.id});case 2:if(a=t.sent,r=a.data,0==r.code){t.next=6;break}return t.abrupt("return",e.$message.error(r.msg));case 6:e.$message({type:"success",message:"删除成功!"}),e.init();case 8:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},getType:function(e){switch(e){case 0:return"IP白名单";case 1:return"sn校验";case 2:return"token";case 3:return"不校验"}}}},m=g,v=(a("63a8"),a("2877")),b=Object(v["a"])(m,r,n,!1,null,"d5cc7af8",null);t["default"]=b.exports},"63a8":function(e,t,a){"use strict";a("d6f7")},"70da":function(e,t,a){"use strict";var r=a("7bc1");t["a"]={tree:function(e){return r["a"].get("/data-share/api-catalog/getTree",e)},use:function(e){return r["a"].get("/data-share/api-catalog/updateUsableById",e)},add:function(e){return r["a"].post("/data-share/api-catalog/add",e)},save:function(e){return r["a"].post("/data-share/api-catalog/edit",e)},del:function(e){return r["a"].get("/data-share/api-catalog/deleteById",e)}}},d6f7:function(e,t,a){}}]);